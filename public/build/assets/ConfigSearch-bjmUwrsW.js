import{a6 as j,F as y,H as C,J as H,K as z,c as a,b as m,a as s,i as V,y as w,z as R,ae as I,Y as S,d as f,ai as O,v as d,t as r,Z as K,$ as P,a8 as J,aa as Y,S as Z,s as h,o as c}from"./app-D2xsl8rd.js";import{u as q}from"./index-CNlVbg3U.js";import{P as A}from"./PageHeader-jQFlwj8n.js";import{L as G}from"./LoadingSpinner-CKi4qMsx.js";import{u as Q}from"./scrollToBottom-Cz-iWedv.js";import{D as W}from"./DeviceCategoryField-C6-RVxVP.js";import{C as T}from"./CopyLogo-DEQs2MLU.js";/* empty css               */import"./ViewFunctions-C6cuRbX0.js";const X={components:{PageHeader:A,LoadingSpinner:G,DeviceCategoryField:W,CopyIcon:T},setup(){J();const u=Y("create-notification"),e=y({editid:0,pagename:"Config Search",pagedesc:"Search config files",pagenamesingle:"Search",modelName:"searches"}),l=y({device_category_id:"",line_count:0,search_string:"",search_latest_only:!0,category:[]}),o=y({device_category_id:"",line_count:""}),b=C(!1),v=y({}),{toClipboard:k}=q(),g=C(!1),{scrollToBottom:x}=Q(),p=C(!1);function t(){Z.post("/api/configs/search",{category:l.device_category_id,line_count:l.line_count,search_string:l.search_string,latestOnly:l.search_latest_only}).then(n=>{Object.assign(v,n.data),u({type:"success",message:`Searched for '${l.search_string}' in ${n.data.fileCount} configs...`}),b.value=!1}).catch(n=>{u({type:"error",message:n.response.data.message})})}const _=async n=>{try{await k(n),g.value=!0,setTimeout(()=>{g.value=!1},3e3),u({type:"success",title:"Copy Successful",message:"Configuration copied to clipboard"})}catch(i){u({type:"danger",title:"Error",message:i.response})}};function E(n){n.expanded===!0?n.expanded=!1:n.expanded=!0}function L(n){var i=n.slice(1);return i=i.join(`\r
`),i=i.replace(/model.search_string/g,'<span class="pf-u-warning-color-100">'+l.search_string+"</span>"),i}function B(n){var i=L(n),U=new RegExp(`\\b${l.search_string}\\b`,"gi");return l.search_string=M(l.search_string),i=i.replace(U,'<span class="pf-u-warning-color-200 pf-u-background-color-warning">'+l.search_string+"</span>"),i}function M(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"")}function N(){l.device_category_id="",l.category=[],l.line_count=0,l.search_string="",l.search_latest_only=!0,Object.assign(v,{matchCount:0,search_results:{}})}function F(){document.getElementById("top_div").scrollIntoView({behavior:"smooth"})}const D=n=>{document.getElementById("top_div").getBoundingClientRect().top<0?p.value=!0:p.value=!1};return H(()=>{window.addEventListener("wheel",D,{passive:!0})}),z(()=>{window.removeEventListener("wheel",D)}),{viewstate:e,model:l,errors:o,search:t,clear:N,scrollToBottom:x,isLoading:b,results:v,toggleExpandResults:E,stringifyResult:L,displayResult:B,copy:_,CopyIcon:T,scrollToTop:F,showScrollBtn:p,copied:g}}},$={class:"pf-c-page__main",tabindex:"-1"},ss={class:"pf-c-page__main-section pf-m-no-padding"},es={class:"pf-c-drawer__main"},os={class:"pf-c-drawer__content pf-m-no-background"},ts={class:"pf-c-drawer__body pf-m-padding"},ls={class:"pf-c-card"},ns={class:"pf-c-card__body"},is={novalidate:"",class:"pf-c-form pf-m-horizontal"},as={class:"pf-c-form__group"},cs={class:"pf-c-form__group-control"},rs={class:"pf-c-form__group"},ds={class:"pf-c-form__group-control"},ps={class:"pf-c-search-input"},fs={class:"pf-c-search-input__bar"},_s={class:"pf-c-search-input__text"},ms={class:"pf-c-switch pf-m-reverse",for:"search_latest_only"},us={class:"pf-c-wizard__footer"},gs={key:0,class:"pf-c-card pf-u-mt-lg",id:"summary_card"},vs={class:"pf-c-card__body"},ys={key:0,class:"pf-c-skeleton"},hs={key:1,class:"pf-l-grid pf-m-all-6-col-on-sm pf-m-all-3-col-on-lg pf-m-gutter"},bs={class:"pf-l-grid__item"},ks={class:"pf-l-flex pf-m-space-items-sm"},xs={class:"pf-l-flex__item"},Cs={class:"pf-l-grid__item"},ws={class:"pf-l-flex pf-m-space-items-sm"},Ss={class:"pf-l-flex__item"},Ls={class:"pf-l-grid__item"},Ds={class:"pf-l-flex pf-m-space-items-sm"},Vs={class:"pf-l-flex__item"},Rs={class:"pf-l-grid__item"},Ts={class:"pf-l-flex pf-m-space-items-sm"},Es={class:"pf-l-flex__item"},Bs={key:1,class:"pf-c-card pf-u-mt-lg"},Ms={class:"pf-c-card__body"},Ns={key:0,class:"pf-c-skeleton"},Fs={key:1},Us={class:"pf-l-grid pf-m-gutter pf-u-mb-md"},js={class:"pf-l-grid__item pf-m-3-col copyLinkDD"},Hs=["onClick"],zs={class:"pf-l-grid__item pf-m-3-col copyLinkDD"},Is=["onClick"],Os={class:"pf-l-grid__item pf-m-3-col copyLinkDD"},Ks=["onClick"],Ps={class:"pf-l-grid__item pf-m-3-col copyLinkDD"},Js=["onClick"],Ys=["onClick"],Zs={class:"pf-c-expandable-section__toggle-text"},qs={key:0},As={key:1},Gs=["hidden"],Qs={class:"pf-c-code-block"},Ws={class:"pf-c-code-block__header"},Xs={class:"pf-c-code-block__actions"},$s={class:"pf-c-code-block__actions-item"},se=["onClick"],ee={class:"pf-c-code-block__content"},oe={class:"pf-c-code-block__pre"},te={class:"pf-c-code-block__code"},le=["innerHTML"],ne={key:2,class:"pf-c-back-to-top"};function ie(u,e,l,o,b,v){const k=h("page-header"),g=h("device-category-field"),x=h("loading-spinner"),p=h("copy-icon");return c(),a("main",$,[m(k,{pagename:o.viewstate.pagename,desc:o.viewstate.pagedesc},null,8,["pagename","desc"]),e[41]||(e[41]=s("div",{class:"pf-c-divider",role:"separator"},null,-1)),s("section",ss,[s("div",{class:V(["pf-c-drawer",{"pf-m-expanded":o.viewstate.openDrawerState}]),id:"top_div"},[s("div",es,[s("div",os,[s("div",ts,[s("div",ls,[e[17]||(e[17]=s("div",{class:"pf-c-card__header pf-l-flex"},[s("div",{class:"pf-c-check pf-l-flex__item pf-m-align-right"})],-1)),s("div",ns,[s("form",is,[m(g,{modelValue:o.model,"onUpdate:modelValue":e[0]||(e[0]=t=>o.model=t),updateValue:o.model.device_category_id,"onUpdate:updateValue":e[1]||(e[1]=t=>o.model.device_category_id=t),errors:o.errors},null,8,["modelValue","updateValue","errors"]),s("div",as,[e[10]||(e[10]=s("div",{class:"pf-c-form__group-label"},[s("label",{class:"pf-c-form__label",for:"line_count"},[s("span",{class:"pf-c-form__label-text"},"Line Count")]),s("button",{class:"pf-c-form__group-label-help","aria-label":"More info",tabindex:"-1"})],-1)),s("div",cs,[w(s("input",{type:"number",id:"line_count",class:"pf-c-form-control","onUpdate:modelValue":e[2]||(e[2]=t=>o.model.line_count=t),autocomplete:"nope"},null,512),[[R,o.model.line_count]]),e[9]||(e[9]=s("small",null,"Number of output lines before and after search match.",-1))])]),s("div",rs,[e[13]||(e[13]=s("div",{class:"pf-c-form__group-label"},[s("label",{class:"pf-c-form__label",for:"search_string"},[s("span",{class:"pf-c-form__label-text"},"Search String")]),s("button",{class:"pf-c-form__group-label-help","aria-label":"More info",tabindex:"-1"})],-1)),s("div",ds,[s("div",ps,[s("div",fs,[s("span",_s,[e[11]||(e[11]=s("span",{class:"pf-c-search-input__icon"},[s("i",{class:"fas fa-search fa-fw","aria-hidden":"true"})],-1)),w(s("input",{class:"pf-c-search-input__text-input",type:"text",placeholder:"Search string","aria-label":"Search string","onUpdate:modelValue":e[3]||(e[3]=t=>o.model.search_string=t),autocomplete:"off",onKeydown:e[4]||(e[4]=I(S(t=>o.search(),["prevent"]),["enter"]))},null,544),[[R,o.model.search_string]])])])]),e[12]||(e[12]=s("small",null,[f("Full or partial string to search for. RegExp character classes can be also be used. See here for a RegExp cheat sheet "),s("a",{href:"https://devhints.io/regexp",target:"_blank"},"https://devhints.io/regexp")],-1))])]),s("label",ms,[w(s("input",{class:"pf-c-switch__input",type:"checkbox",id:"search_latest_only","aria-labelledby":"search_latest_only-on",name:"switchExample1","onUpdate:modelValue":e[5]||(e[5]=t=>o.model.search_latest_only=t)},null,512),[[O,o.model.search_latest_only]]),e[14]||(e[14]=s("span",{class:"pf-c-switch__toggle"},null,-1)),e[15]||(e[15]=s("span",{class:"pf-c-switch__label pf-m-on",id:"search_latest_only-on","aria-hidden":"true"},"Search latest only on",-1)),e[16]||(e[16]=s("span",{class:"pf-c-switch__label pf-m-off",id:"search_latest_only-off","aria-hidden":"true"},"Search latest only off",-1))]),s("footer",us,[s("button",{class:"pf-c-button pf-m-primary",type:"button",onClick:e[6]||(e[6]=S(t=>o.search(),["prevent"]))},"Search"),s("button",{"aria-disabled":"false",class:"pf-c-button pf-m-link",type:"button",onClick:e[7]||(e[7]=S((...t)=>o.clear&&o.clear(...t),["prevent"]))},"Clear")])])])]),m(x,{showSpinner:o.isLoading},null,8,["showSpinner"]),o.results.search_results&&Object.keys(o.results.search_results).length>0?(c(),a("div",gs,[e[26]||(e[26]=s("div",{class:"pf-c-card__header"},[s("h2",{class:"pf-c-title pf-m-lg"},"Summary")],-1)),s("div",vs,[o.isLoading?(c(),a("div",ys)):d("",!0),o.isLoading?d("",!0):(c(),a("div",hs,[s("div",bs,[s("div",ks,[e[18]||(e[18]=s("div",{class:"pf-l-flex__item"},[s("i",{class:"fas fa-check-circle pf-u-success-color-100"})],-1)),s("div",xs,[s("span",null,r(o.results.duration),1)]),e[19]||(e[19]=s("div",{class:"pf-l-flex__item"},[s("span",{class:"pf-u-color-400"},"Search Duration ")],-1))])]),s("div",Cs,[s("div",ws,[e[20]||(e[20]=s("div",{class:"pf-l-flex__item"},[s("i",{class:"fas fa-check-circle pf-u-success-color-100"})],-1)),s("div",Ss,[s("span",null,r(o.results.fileCount),1)]),e[21]||(e[21]=s("div",{class:"pf-l-flex__item"},[s("span",{class:"pf-u-color-400"}," Files Searched")],-1))])]),s("div",Ls,[s("div",Ds,[e[22]||(e[22]=s("div",{class:"pf-l-flex__item"},[s("i",{class:"fas fa-check-circle pf-u-success-color-100"})],-1)),s("div",Vs,[s("span",null,r(o.results.lineCount),1)]),e[23]||(e[23]=s("div",{class:"pf-l-flex__item"},[s("span",{class:"pf-u-color-400"}," Lines Searched")],-1))])]),s("div",Rs,[s("div",Ts,[e[24]||(e[24]=s("div",{class:"pf-l-flex__item"},[s("i",{class:"fas fa-check-circle pf-u-success-color-100"})],-1)),s("div",Es,[s("span",null,r(o.results.matchCount),1)]),e[25]||(e[25]=s("div",{class:"pf-l-flex__item"},[s("span",{class:"pf-u-color-400"},"Matches ")],-1))])])]))])])):d("",!0),o.results.matchCount>0?(c(),a("div",Bs,[e[39]||(e[39]=s("div",{class:"pf-c-card__header"},[s("h2",{class:"pf-c-title pf-m-lg"},"Results")],-1)),s("div",Ms,[o.isLoading?(c(),a("div",Ns)):d("",!0),o.isLoading?d("",!0):(c(),a("div",Fs,[(c(!0),a(K,null,P(o.results.search_results,t=>(c(),a("div",{class:V(["pf-c-expandable-section pf-m-display-lg pf-m-limit-width pf-u-mb-md",{"pf-m-expanded":t.expanded}]),style:{padding:"1rem","background-color":"white","border-bottom":"1px solid #f8f8f8",transition:"width 0.2s ease-in-out"},key:t},[s("div",Us,[s("div",js,[e[27]||(e[27]=s("b",null,"Device Name:",-1)),e[28]||(e[28]=f()),s("span",null,r(t[0][4]),1),s("button",{class:"pf-c-button pf-m-inline pf-m-link pf-u-color-100 copyLink",type:"button",alt:"copy",title:"copy",onClick:_=>o.copy(t[0][4])},[m(p)],8,Hs)]),s("div",zs,[e[29]||(e[29]=s("b",null,"Category:",-1)),e[30]||(e[30]=f()),s("span",null,r(t[0][5]),1),s("button",{class:"pf-c-button pf-m-inline pf-m-link pf-u-color-100 copyLink",type:"button",alt:"copy",title:"copy",onClick:_=>o.copy(t[0][5])},[m(p)],8,Is)]),s("div",Os,[e[31]||(e[31]=s("b",null,"Date: ",-1)),e[32]||(e[32]=f()),s("span",null,r(t[0][1])+" "+r(t[0][2])+" "+r(t[0][3]),1),s("button",{class:"pf-c-button pf-m-inline pf-m-link pf-u-color-100 copyLink",type:"button",alt:"copy",title:"copy",onClick:_=>o.copy(t[0][1]+" "+t[0][2]+" "+t[0][3])},[m(p)],8,Ks)]),s("div",Ps,[e[33]||(e[33]=s("b",null,"Filename:",-1)),e[34]||(e[34]=f()),s("span",null,r(t[0][0]),1),s("button",{class:"pf-c-button pf-m-inline pf-m-link pf-u-color-100 copyLink",type:"button",alt:"copy",title:"copy",onClick:_=>o.copy(t[0][0])},[m(p)],8,Js)])]),s("div",null,[s("button",{type:"button",class:"pf-c-expandable-section__toggle","aria-expanded":"false",onClick:_=>o.toggleExpandResults(t)},[e[37]||(e[37]=s("span",{class:"pf-c-expandable-section__toggle-icon"},[s("i",{class:"fas fa-angle-right","aria-hidden":"true"})],-1)),s("span",Zs,[t.expanded?d("",!0):(c(),a("span",qs,"Show")),e[35]||(e[35]=f()),t.expanded?(c(),a("span",As,"Hide")):d("",!0),e[36]||(e[36]=f(" search results"))])],8,Ys),s("div",{class:"pf-c-expandable-section__content",hidden:!t.expanded},[s("div",Qs,[s("div",Ws,[s("div",Xs,[s("div",$s,[s("button",{class:"pf-c-button pf-m-plain",type:"button",alt:"Copy to clipboard",title:"Copy to clipboard",onClick:_=>o.copy(o.stringifyResult(t))},e[38]||(e[38]=[s("i",{class:"fas fa-copy","aria-hidden":"true"},null,-1)]),8,se)])])]),s("div",ee,[s("pre",oe,[s("code",te,[s("div",{innerHTML:o.displayResult(t)},null,8,le)])])])])],8,Gs)])],2))),128))]))])])):d("",!0),o.results.matchCount>0&&o.showScrollBtn?(c(),a("div",ne,[s("button",{class:"pf-c-button pf-m-primary",onClick:e[8]||(e[8]=(...t)=>o.scrollToTop&&o.scrollToTop(...t))},e[40]||(e[40]=[f(" Back to top "),s("span",{class:"pf-c-button__icon pf-m-end"},[s("i",{class:"fas fa-angle-up","aria-hidden":"true"})],-1)]))])):d("",!0)])])])],2)])])}const ge=j(X,[["render",ie]]);export{ge as default};
