import{e as Q,b as v,y as W,f as R,G as q,Q as O,g as b,o as p,x as N,w as l,h as s,u as e,H as Z,J as ee,K as se,l as o,t as k,j as i,c as S,m as C,O as te,I as ae,P as le,R as oe,S as G,T as ne,F as re,D as de}from"./app-TTnvB57g.js";import{u as X,w as ie,x as ue,y as ce,z as me,A as pe,B as H,a as ge,k as ve,b as fe,c as J,d as B,e as _e,j as we,f as ye,g as K,h as xe,i as ke}from"./SelectScrollDownButton-Dk70VVbL.js";/* empty css               */const $e={class:"flex items-center"},be={class:"ml-2"},Ue={class:"grid gap-2 p-4"},De={class:"grid items-center grid-cols-4 gap-4"},Ie={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Ve={class:"grid items-center grid-cols-4 gap-4"},Ce={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Pe={class:"grid items-center grid-cols-4 gap-4"},Ee={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Se={class:"grid items-center grid-cols-4 gap-4"},Ne={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},he={class:"grid items-center grid-cols-4 gap-4"},Le={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Me={key:1,class:"col-start-2 -mt-4 text-sm text-green-400"},Te={class:"grid items-center grid-cols-4 gap-4"},Ae={class:"pl-2 ml-auto"},Be={class:"rc-kdb-class2"},Ke={class:"pl-2 ml-auto"},je={class:"rc-kdb-class2"},Fe={__name:"UserAddEditDialog",props:{editId:Number},emits:["save"],setup(f,{emit:P}){const{toastSuccess:$,toastError:h,toastInfo:T,toastWarning:L,toastDefault:M}=Q(),E=X(),{openDialog:j,closeDialog:_,isDialogOpen:A}=E,U=P;v([]);const c=v([]),r=v({name:"",username:"",email:"",password:"",repeat_password:"",role:""}),w=v(""),g=f;function y(x){x.ctrlKey&&x.key==="Enter"&&D()}W(()=>{g.editId>0&&R.get(`/api/users/${g.editId}`).then(x=>{r.value=x.data}),window.addEventListener("keydown",y)}),q(()=>{window.removeEventListener("keydown",y)}),O(()=>[r.value.password,r.value.repeat_password],()=>{r.value.password!==r.value.repeat_password?(w.value="",c.value.repeat_password=["Passwords do not match"]):(delete c.value.repeat_password,w.value="Passwords match")});function D(){let x=g.editId>0?`/${g.editId}`:"",t=g.editId>0?"patch":"post";R[t]("/api/users"+x,r.value).then(I=>{U("save",I.data),$("User created","The tag has been created successfully."),_("DialogNewUser")}).catch(I=>{c.value=I.response.data.errors})}return(x,t)=>{const I=b("UserIcon"),V=b("Label"),a=b("Input"),d=b("Button"),m=b("Icon");return p(),N(e(le),{open:e(A)("DialogNewUser")},{default:l(()=>[s(e(Z),{"as-child":""}),s(e(ae),{class:"p-0 sm:max-w-fit",onEscapeKeyDown:t[9]||(t[9]=u=>e(_)("DialogNewUser")),onPointerDownOutside:t[10]||(t[10]=u=>e(_)("DialogNewUser")),onCloseClicked:t[11]||(t[11]=u=>e(_)("DialogNewUser"))},{default:l(()=>[s(e(ee),{class:"rc-dialog-header"},{default:l(()=>[s(e(se),{class:"text-sm text-rcgray-200"},{default:l(()=>[o("div",$e,[s(I),o("span",be,k(f.editId>0?"Edit":"Add")+" User "+k(f.editId>0?"(ID: "+f.editId+")":""),1)])]),_:1})]),_:1}),o("div",Ue,[o("div",De,[s(V,{for:"name",class:"text-right"},{default:l(()=>t[12]||(t[12]=[i(" Name "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(a,{modelValue:r.value.name,"onUpdate:modelValue":t[0]||(t[0]=u=>r.value.name=u),id:"name",class:"col-span-3",autocomplete:"off"},null,8,["modelValue"]),c.value.name?(p(),S("span",Ie,k(c.value.name[0]),1)):C("",!0)]),o("div",Ve,[s(V,{for:"username",class:"text-right"},{default:l(()=>t[13]||(t[13]=[i(" User Name ")])),_:1}),s(a,{modelValue:r.value.username,"onUpdate:modelValue":t[1]||(t[1]=u=>r.value.username=u),id:"username",class:"col-span-3"},null,8,["modelValue"]),c.value.username?(p(),S("span",Ce,k(c.value.username[0]),1)):C("",!0)]),o("div",Pe,[s(V,{for:"email",class:"text-right"},{default:l(()=>t[14]||(t[14]=[i(" Email "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(a,{modelValue:r.value.email,"onUpdate:modelValue":t[2]||(t[2]=u=>r.value.email=u),id:"email",type:"email",class:"col-span-3"},null,8,["modelValue"]),c.value.email?(p(),S("span",Ee,k(c.value.email[0]),1)):C("",!0)]),o("div",Se,[s(V,{for:"password",class:"text-right"},{default:l(()=>t[15]||(t[15]=[i(" Password "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(a,{type:"password",modelValue:r.value.password,"onUpdate:modelValue":t[3]||(t[3]=u=>r.value.password=u),id:"password",class:"col-span-3"},null,8,["modelValue"]),c.value.password&&f.editId===0?(p(),S("span",Ne,k(c.value.password[0]),1)):C("",!0)]),o("div",he,[s(V,{for:"repeat_password",class:"text-right"},{default:l(()=>t[16]||(t[16]=[i(" Repeat Password "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(a,{type:"password",modelValue:r.value.repeat_password,"onUpdate:modelValue":t[4]||(t[4]=u=>r.value.repeat_password=u),id:"repeat_password",class:"col-span-3"},null,8,["modelValue"]),c.value.repeat_password&&f.editId===0?(p(),S("span",Le,k(c.value.repeat_password[0]),1)):C("",!0),w.value&&f.editId===0?(p(),S("span",Me,k(w.value),1)):C("",!0)]),o("div",Te,[s(V,{for:"repeat_password",class:"text-right"},{default:l(()=>t[17]||(t[17]=[i(" Role "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(e(ie),{modelValue:r.value.role,"onUpdate:modelValue":t[5]||(t[5]=u=>r.value.role=u)},{default:l(()=>[s(e(ue),{class:"col-span-3"},{default:l(()=>[s(e(ce),{placeholder:"Select a role"})]),_:1}),s(e(me),null,{default:l(()=>[s(e(pe),null,{default:l(()=>[s(e(H),{value:"admin"},{default:l(()=>t[18]||(t[18]=[i("Admin")])),_:1}),s(e(H),{value:"user"},{default:l(()=>t[19]||(t[19]=[i("User")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),s(e(te),{class:"rc-dialog-footer bg-rcgray-800"},{default:l(()=>[s(d,{type:"close",variant:"outline",class:"px-2 py-1 ml-2 text-sm hover:bg-gray-700 hover:animate-pulse",onClick:t[6]||(t[6]=u=>e(_)("DialogNewUser")),size:"sm"},{default:l(()=>t[20]||(t[20]=[i(" Cancel "),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"rc-kdb-class"},"ESC")],-1)])),_:1}),g.editId===0?(p(),N(d,{key:0,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[7]||(t[7]=u=>D()),variant:"primary"},{default:l(()=>[t[22]||(t[22]=i(" Save ")),o("div",Ae,[o("kbd",Be,[t[21]||(t[21]=i(" Ctrl  ")),s(m,{icon:"uil:enter",class:""})])])]),_:1})):C("",!0),g.editId>0?(p(),N(d,{key:1,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[8]||(t[8]=u=>D()),variant:"primary"},{default:l(()=>[t[24]||(t[24]=i(" Update ")),o("div",Ke,[o("kbd",je,[t[23]||(t[23]=i(" Ctrl  ")),s(m,{icon:"uil:enter",class:""})])])]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1},8,["open"])}}};function Oe(){const f=v(1),P=v(parseInt(localStorage.getItem("perPage")||"10")),$=v("-id"),h=v(""),T=v({}),L=X(),M=v(0),E=v(!1),j=v(1),_=v(1),A=v([]),{openDialog:U}=L,{toastSuccess:c,toastError:r}=Q();async function w(d={}){E.value=!0;try{const m=await R.get("/api/users",{params:{page:f.value,perPage:P.value,sort:$.value,...T.value}});A.value=m.data,j.value=m.data.last_page}catch(m){console.error("Error fetching users:",m),r("Error","Failed to fetch users.")}finally{E.value=!1}}const g=d=>{M.value=0,_.value=Math.random(),U("DialogNewUser")};function y(d){M.value=d,_.value=Math.random(),U("DialogNewUser")}const D=async d=>{try{await R.delete(`/api/users/${d}`),w(),c("User Deleted","The user has been deleted successfully.")}catch(m){console.error("Error deleting user:",m),r("Error","Failed to delete user.")}},x=d=>{M.value=d,_.value=Math.random(),U("DialogNewUser")},t=()=>{w(),_.value=Math.random()};function I(d){d.altKey&&d.key==="n"&&(d.preventDefault(),U("DialogNewUser"))}const V=oe(()=>{T.value["filter[name]"]=h.value,f.value=1,w()},500);O([f,P],()=>{w()}),O(h,()=>{V()}),O(P,d=>{localStorage.setItem("perPage",d.toString())});function a(d){$.value===d?$.value=`-${d}`:$.value=d,w()}return{users:A,isLoading:E,currentPage:f,perPage:P,lastPage:j,editId:M,newUserModalKey:_,searchTerm:h,openDialog:U,fetchUsers:w,createUser:g,updateUser:y,deleteUser:D,handleSave:t,handleKeyDown:I,viewEditDialog:x,toggleSort:a,sortParam:$}}const Re={class:"flex flex-col h-full gap-1 text-center"},ze={class:"flex items-center justify-between p-4"},Ge={class:"flex items-center"},He={class:"flex"},Je={class:"px-6"},Xe={__name:"Main",setup(f){const{editId:P,users:$,currentPage:h,perPage:T,searchTerm:L,lastPage:M,isLoading:E,fetchUsers:j,viewEditDialog:_,createUser:A,deleteUser:U,handleSave:c,handleKeyDown:r,newUserModalKey:w,toggleSort:g,sortParam:y}=Oe(),{selectedRows:D,selectAll:x,toggleSelectAll:t,toggleSelectRow:I}=ge($);return W(()=>{j(),window.addEventListener("keydown",r)}),q(()=>{window.removeEventListener("keydown",r)}),(V,a)=>{const d=b("Input"),m=b("Button"),u=b("Checkbox"),F=b("Icon"),Y=b("Toaster");return p(),S("div",Re,[o("div",ze,[o("div",Ge,[s(d,{class:"max-w-sm ml-4",autocomplete:"off","data-1p-ignore":"","data-lpignore":"true",placeholder:"Filter users...",modelValue:e(L),"onUpdate:modelValue":a[0]||(a[0]=n=>G(L)?L.value=n:null)},null,8,["modelValue"]),s(m,{class:"ml-2 hover:bg-gray-800",variant:"outline",onClick:a[1]||(a[1]=n=>L.value="")},{default:l(()=>a[11]||(a[11]=[i(" Clear Filter ")])),_:1})]),o("div",He,[e(D).length?(p(),N(m,{key:0,class:"px-2 py-1 bg-red-600 hover:bg-red-700 hover:animate-pulse",size:"md",variant:"primary"},{default:l(()=>[i(" Delete Selected "+k(e(D).length)+" User(s) ",1)]),_:1})):C("",!0),s(m,{type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:ne(e(A),["prevent"]),variant:"primary"},{default:l(()=>a[12]||(a[12]=[i(" New User "),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"rc-kdb-class2"},"ALT N")],-1)])),_:1},8,["onClick"])])]),o("div",Je,[s(e(we),null,{default:l(()=>[s(e(fe),null,{default:l(()=>[s(e(J),null,{default:l(()=>[s(e(B),{class:"w-[2%]"},{default:l(()=>[s(u,{id:"selectAll",modelValue:e(x),"onUpdate:modelValue":a[2]||(a[2]=n=>G(x)?x.value=n:null),onClick:a[3]||(a[3]=n=>e(t)())},null,8,["modelValue"])]),_:1}),s(e(B),{class:"w-[5%]"},{default:l(()=>[s(m,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[4]||(a[4]=n=>e(g)("id"))},{default:l(()=>[s(F,{icon:e(y)==="id"?"lucide:sort-asc":e(y)==="-id"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[13]||(a[13]=o("span",{class:"ml-2"},"ID",-1))]),_:1})]),_:1}),s(e(B),{class:"w-[20%]"},{default:l(()=>[s(m,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[5]||(a[5]=n=>e(g)("name"))},{default:l(()=>[s(F,{icon:e(y)==="name"?"lucide:sort-asc":e(y)==="-name"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[14]||(a[14]=o("span",{class:"ml-2"},"Name",-1))]),_:1})]),_:1}),s(e(B),{class:"w-[20%]"},{default:l(()=>[s(m,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[6]||(a[6]=n=>e(g)("email"))},{default:l(()=>[s(F,{icon:e(y)==="email"?"lucide:sort-asc":e(y)==="-email"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[15]||(a[15]=o("span",{class:"ml-2"},"Email",-1))]),_:1})]),_:1}),s(e(B),{class:"w-[20%]"},{default:l(()=>[s(m,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[7]||(a[7]=n=>e(g)("last_login"))},{default:l(()=>[s(F,{icon:e(y)==="last_login"?"lucide:sort-asc ":e(y)==="-last_login"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[16]||(a[16]=o("span",{class:"ml-2"},"Last Login",-1))]),_:1})]),_:1}),s(e(B),{class:"w-[10%]"},{default:l(()=>a[17]||(a[17]=[i("Actions")])),_:1})]),_:1})]),_:1}),s(e(_e),null,{default:l(()=>[e(E)?(p(),N(ye,{key:0})):e(E)?(p(),N(ke,{key:2})):(p(!0),S(re,{key:1},de(e($).data,n=>(p(),N(e(J),{key:n.id},{default:l(()=>[s(e(K),{class:"text-start"},{default:l(()=>[s(u,{class:"cursor-pointer",id:"select-"+n.id,checked:!!e(D).includes(n.id),onClick:z=>e(I)(n.id)},null,8,["id","checked","onClick"])]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[i(k(n.id),1)]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[i(k(n.name),1)]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[i(k(n.email),1)]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[i(k(n.last_login),1)]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[s(xe,{rowData:n,onOnEdit:z=>e(_)(n.id),onOnDelete:z=>e(U)(n.id)},null,8,["rowData","onOnEdit","onOnDelete"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),s(ve,{currentPage:e(h),lastPage:e(M),perPage:e(T),"onUpdate:currentPage":a[8]||(a[8]=n=>h.value=n),"onUpdate:perPage":a[9]||(a[9]=n=>T.value=n)},null,8,["currentPage","lastPage","perPage"]),(p(),N(Fe,{onSave:a[10]||(a[10]=n=>e(c)()),key:e(w),editId:e(P)},null,8,["editId"])),s(Y)])])}}};export{Xe as default};
