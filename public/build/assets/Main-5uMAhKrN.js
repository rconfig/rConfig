import{b as g,H as X,e as K,J as q,f as O,o as p,v as E,w as l,g as s,u as e,K as Z,M as ee,N as se,i as r,t as x,O as te,k as i,c as j,l as T,P as ae,Q as $,L as le,R as ne,S as F,T as oe,U as B,V as ie,W as re,X as de}from"./app-7hO3kobU.js";import{u as G,_ as W,a as z,b as ue,m as ce,c as me,d as H,e as A,f as Q,g as fe,l as ge,h as ve,i as L,j as pe,k as ye}from"./useRowSelection-C1C3sNwh.js";import{u as Y}from"./useToaster-BYDoeTf1.js";/* empty css               */const _e={class:"grid gap-2 py-4"},we={class:"grid items-center grid-cols-4 gap-4"},$e={class:"grid items-center grid-cols-4 gap-4"},xe={class:"flex flex-col w-full space-y-2"},ke={key:0,class:"text-red-400"},be={key:1,class:"text-red-400"},De={class:"pl-2 ml-auto"},Ue={class:"bxnAJf2"},Ie={class:"pl-2 ml-auto"},Ce={class:"bxnAJf2"},Ee={__name:"UserAddEditDialog",props:{editId:Number},emits:["save"],setup(y,{emit:U}){const{toastSuccess:_,toastError:P,toastInfo:h,toastWarning:S,toastDefault:N}=Y(),I=G(),{openDialog:M,closeDialog:c,isDialogOpen:V}=I,k=U;g([]);const b=g([]),v=g({username:"",email:""}),d=y;function D(m){m.ctrlKey&&m.key==="Enter"&&u()}X(()=>{d.editId>0&&K.get(`/api/users/${d.editId}`).then(m=>{v.value=m.data}),window.addEventListener("keydown",D)}),q(()=>{window.removeEventListener("keydown",D)});function u(){let m=d.editId>0?`/${d.editId}`:"",t=d.editId>0?"patch":"post";K[t]("/api/users"+m,v.value).then(w=>{k("save",w.data),_("User created","The tag has been created successfully."),c("DialogNewUser")}).catch(w=>{b.value=w.response.data.errors})}return(m,t)=>{const w=O("Icon");return p(),E(e(ne),{open:e(V)("DialogNewUser")},{default:l(()=>[s(e(Z),{"as-child":""}),s(e(le),{class:"sm:max-w-[425px]",onEscapeKeyDown:t[5]||(t[5]=f=>e(c)("DialogNewUser")),onPointerDownOutside:t[6]||(t[6]=f=>e(c)("DialogNewUser")),onCloseClicked:t[7]||(t[7]=f=>e(c)("DialogNewUser"))},{default:l(()=>[s(e(ee),null,{default:l(()=>[s(e(se),null,{default:l(()=>[r(x(y.editId>0?"Edit":"Add")+" User "+x(y.editId>0?"(ID: "+y.editId+")":""),1)]),_:1}),s(e(te),null,{default:l(()=>[r("Make changes to your tag here. Click "+x(y.editId>0?"update":"save")+" when you're done.",1)]),_:1})]),_:1}),i("div",_e,[i("div",we,[s(e(W),{for:"username",class:"text-right"},{default:l(()=>t[8]||(t[8]=[r(" User Name ")])),_:1}),s(e(z),{modelValue:v.value.username,"onUpdate:modelValue":t[0]||(t[0]=f=>v.value.username=f),id:"username",class:"col-span-3"},null,8,["modelValue"])]),i("div",$e,[s(e(W),{for:"email",class:"text-right"},{default:l(()=>t[9]||(t[9]=[r(" Description ")])),_:1}),s(e(z),{modelValue:v.value.email,"onUpdate:modelValue":t[1]||(t[1]=f=>v.value.email=f),id:"email",class:"col-span-3"},null,8,["modelValue"])])]),i("div",xe,[b.value.email?(p(),j("span",ke,x(b.value.email[0]),1)):T("",!0),b.value.username?(p(),j("span",be,x(b.value.username[0]),1)):T("",!0)]),s(e(ae),null,{default:l(()=>[s(e($),{type:"close",variant:"outline",class:"px-2 py-1 ml-2 text-sm hover:bg-gray-700 hover:animate-pulse",onClick:t[2]||(t[2]=f=>e(c)("DialogNewUser")),size:"sm"},{default:l(()=>t[10]||(t[10]=[r(" Cancel "),i("div",{class:"pl-2 ml-auto"},[i("kbd",{class:"bxnAJf"},"ESC")],-1)])),_:1}),d.editId===0?(p(),E(e($),{key:0,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[3]||(t[3]=f=>u()),variant:"primary"},{default:l(()=>[t[12]||(t[12]=r(" Save ")),i("div",De,[i("kbd",Ue,[t[11]||(t[11]=r(" Ctrl  ")),s(w,{icon:"uil:enter",class:""})])])]),_:1})):T("",!0),d.editId>0?(p(),E(e($),{key:1,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[4]||(t[4]=f=>u()),variant:"primary"},{default:l(()=>[t[14]||(t[14]=r(" Update ")),i("div",Ie,[i("kbd",Ce,[t[13]||(t[13]=r(" Ctrl  ")),s(w,{icon:"uil:enter",class:""})])])]),_:1})):T("",!0)]),_:1})]),_:1})]),_:1},8,["open"])}}};function Pe(){const y=g(1),U=g(parseInt(localStorage.getItem("perPage")||"10")),_=g("-id"),P=g(""),h=g({}),S=G(),N=g(0),I=g(!1),M=g(1),c=g(1),V=g([]),{openDialog:k}=S,{toastSuccess:b,toastError:v}=Y();async function d(o={}){I.value=!0;try{const C=await K.get("/api/users",{params:{page:y.value,perPage:U.value,sort:_.value,...h.value}});V.value=C.data,M.value=C.data.last_page}catch(C){console.error("Error fetching users:",C),v("Error","Failed to fetch users.")}finally{I.value=!1}}const D=o=>{N.value=0,c.value=Math.random(),k("DialogNewUser")};function u(o){N.value=o,c.value=Math.random(),k("DialogNewUser")}const m=async o=>{try{await K.delete(`/api/users/${o}`),d(),b("User Deleted","The user has been deleted successfully.")}catch(C){console.error("Error deleting user:",C),v("Error","Failed to delete user.")}},t=o=>{N.value=o,c.value=Math.random(),k("DialogNewUser")},w=()=>{d(),c.value=Math.random()};function f(o){o.altKey&&o.key==="n"&&(o.preventDefault(),k("DialogNewUser"))}const J=oe(()=>{h.value["filter[name]"]=P.value,y.value=1,d()},500);F([y,U],()=>{d()}),F(P,()=>{J()}),F(U,o=>{localStorage.setItem("perPage",o.toString())});function a(o){_.value===o?_.value=`-${o}`:_.value=o,d()}return{users:V,isLoading:I,currentPage:y,perPage:U,lastPage:M,editId:N,newUserModalKey:c,searchTerm:P,openDialog:k,fetchUsers:d,createUser:D,updateUser:u,deleteUser:m,handleSave:w,handleKeyDown:f,viewEditDialog:t,toggleSort:a,sortParam:_}}const Se={class:"flex flex-col h-full gap-1 text-center"},Ne={class:"flex items-center justify-between p-4"},he={class:"flex items-center"},Ve={class:"flex"},Ae={class:"px-6"},je={__name:"Main",setup(y){const{editId:U,users:_,currentPage:P,perPage:h,searchTerm:S,lastPage:N,isLoading:I,fetchUsers:M,viewEditDialog:c,createUser:V,deleteUser:k,handleSave:b,handleKeyDown:v,newUserModalKey:d,toggleSort:D,sortParam:u}=Pe(),{selectedRows:m,selectAll:t,toggleSelectAll:w,toggleSelectRow:f}=ue(_);return X(()=>{M(),window.addEventListener("keydown",v)}),q(()=>{window.removeEventListener("keydown",v)}),(J,a)=>{const o=O("Icon"),C=O("Toaster");return p(),j("div",Se,[i("div",Ne,[i("div",he,[s(e(z),{class:"max-w-sm ml-4",autocomplete:"off","data-1p-ignore":"","data-lpignore":"true",placeholder:"Filter users...",modelValue:e(S),"onUpdate:modelValue":a[0]||(a[0]=n=>B(S)?S.value=n:null)},null,8,["modelValue"]),s(e($),{class:"ml-2 hover:bg-gray-800",variant:"outline",onClick:a[1]||(a[1]=n=>S.value="")},{default:l(()=>a[11]||(a[11]=[r(" Clear Filter ")])),_:1})]),i("div",Ve,[e(m).length?(p(),E(e($),{key:0,class:"px-2 py-1 bg-red-600 hover:bg-red-700 hover:animate-pulse",size:"md",variant:"primary"},{default:l(()=>[r(" Delete Selected "+x(e(m).length)+" User(s) ",1)]),_:1})):T("",!0),s(e($),{type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:ie(e(V),["prevent"]),variant:"primary"},{default:l(()=>a[12]||(a[12]=[r(" New User "),i("div",{class:"pl-2 ml-auto"},[i("kbd",{class:"bxnAJf2"},"ALT N")],-1)])),_:1},8,["onClick"])])]),i("div",Ae,[s(e(ge),null,{default:l(()=>[s(e(me),null,{default:l(()=>[s(e(H),null,{default:l(()=>[s(e(A),{class:"w-[2%]"},{default:l(()=>[s(e(Q),{id:"selectAll",modelValue:e(t),"onUpdate:modelValue":a[2]||(a[2]=n=>B(t)?t.value=n:null),onClick:a[3]||(a[3]=n=>e(w)())},null,8,["modelValue"])]),_:1}),s(e(A),{class:"w-[5%]"},{default:l(()=>[s(e($),{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[4]||(a[4]=n=>e(D)("id"))},{default:l(()=>[s(o,{icon:e(u)==="id"?"lucide:sort-asc":e(u)==="-id"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[13]||(a[13]=i("span",{class:"ml-2"},"ID",-1))]),_:1})]),_:1}),s(e(A),{class:"w-[20%]"},{default:l(()=>[s(e($),{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[5]||(a[5]=n=>e(D)("name"))},{default:l(()=>[s(o,{icon:e(u)==="name"?"lucide:sort-asc":e(u)==="-name"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[14]||(a[14]=i("span",{class:"ml-2"},"Name",-1))]),_:1})]),_:1}),s(e(A),{class:"w-[20%]"},{default:l(()=>[s(e($),{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[6]||(a[6]=n=>e(D)("email"))},{default:l(()=>[s(o,{icon:e(u)==="email"?"lucide:sort-asc":e(u)==="-email"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[15]||(a[15]=i("span",{class:"ml-2"},"Email",-1))]),_:1})]),_:1}),s(e(A),{class:"w-[20%]"},{default:l(()=>[s(e($),{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[7]||(a[7]=n=>e(D)("last_login"))},{default:l(()=>[s(o,{icon:e(u)==="last_login"?"lucide:sort-asc ":e(u)==="-last_login"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[16]||(a[16]=i("span",{class:"ml-2"},"Last Login",-1))]),_:1})]),_:1}),s(e(A),{class:"w-[10%]"},{default:l(()=>a[17]||(a[17]=[r("Actions")])),_:1})]),_:1})]),_:1}),s(e(fe),null,{default:l(()=>[e(I)?(p(),E(ve,{key:0})):e(I)?(p(),E(ye,{key:2})):(p(!0),j(re,{key:1},de(e(_).data,n=>(p(),E(e(H),{key:n.id},{default:l(()=>[s(e(L),{class:"text-start"},{default:l(()=>[s(e(Q),{class:"cursor-pointer",id:"select-"+n.id,checked:!!e(m).includes(n.id),onClick:R=>e(f)(n.id)},null,8,["id","checked","onClick"])]),_:2},1024),s(e(L),{class:"text-start"},{default:l(()=>[r(x(n.id),1)]),_:2},1024),s(e(L),{class:"text-start"},{default:l(()=>[r(x(n.name),1)]),_:2},1024),s(e(L),{class:"text-start"},{default:l(()=>[r(x(n.email),1)]),_:2},1024),s(e(L),{class:"text-start"},{default:l(()=>[r(x(n.last_login),1)]),_:2},1024),s(e(L),{class:"text-start"},{default:l(()=>[s(pe,{rowData:n,onOnEdit:R=>e(c)(n.id),onOnDelete:R=>e(k)(n.id)},null,8,["rowData","onOnEdit","onOnDelete"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),s(ce,{currentPage:e(P),lastPage:e(N),perPage:e(h),"onUpdate:currentPage":a[8]||(a[8]=n=>P.value=n),"onUpdate:perPage":a[9]||(a[9]=n=>h.value=n)},null,8,["currentPage","lastPage","perPage"]),(p(),E(Ee,{onSave:a[10]||(a[10]=n=>e(b)()),key:e(d),editId:e(U)},null,8,["editId"])),s(C)])])}}};export{je as default};
