import{u as x}from"./ViewFunctions-C6cuRbX0.js";import{P as O}from"./PageHeader-jQFlwj8n.js";import{D as A,a as V,b as F,u as N,c as H}from"./DeleteModal-BW7zlagY.js";import{D as j}from"./DataTableSpinner-DEUZ5Lyn.js";import{a6 as M,F as R,H as h,aa as E,ac as z,s as b,o as s,c as l,a as o,b as C,w as q,r as K,Z as v,$ as D,i as L,t as k,v as c,f as S,d as y,ad as J,J as P}from"./app-D2xsl8rd.js";import{S as Z}from"./SideDrawer-DOD6jbif.js";import{L as G}from"./LoadingSpinner-CKi4qMsx.js";/* empty css               */const Q={components:{DataTableToolbar:A,DataTableSpinner:j,DataTableEmptyState:V,DataTablePaginate:F},props:{pagename:{type:String},tabledata:{type:Object,required:[]},searchInputDisabled:{type:Boolean,default:!0},newBtnEnabled:{type:Boolean,default:!0},taskRunBtnEnabled:{type:Boolean,default:!1},editBtnEnabled:{type:Boolean,default:!0},rowViewBtnEnabled:{type:Boolean,default:!1}},emits:["openDrawer","deleteRow","pagechanged","showTaskRunConfirmModal","actionLink","viewAction"],setup(i,{emit:e}){const a=R({pageParams:{page:1,per_page:10,filters:null,sortby:"created_at",sortOrder:"desc"},sortIcon:{base:"fas fa-arrows-alt-v",is:"fa-sort",up:"fas fa-long-arrow-alt-up",down:"fas fa-long-arrow-alt-down"}}),t=R({critical:"fas fa-exclamation-circle pf-u-danger-color-100",error:"fas fa-exclamation-circle pf-u-danger-color-100",warn:"fa fa-exclamation-triangle pf-u-warning-color-100",info:"fas fa-fw fa-info-circle pf-u-info-color-100",default:"fas fa-fw fa-info-circle pf-u-info-color-100"}),m=h(a.sortIcon.base),_=h(0);E("create-notification");const{setupResizableTable:u}=N();z(()=>{i.tabledata.isLoading||u()});function p(d,B=!1){e("openDrawer",{id:d,isClone:B})}function f(d){e("deleteRow",d)}function g(){a.pageParams.filters="",e("pagechanged",a.pageParams)}function n(d){a.pageParams.filters=d,e("pagechanged",a.pageParams)}function r(d){a.pageParams.page=d.page,a.pageParams.per_page=d.per_page,e("pagechanged",a.pageParams)}function w(d,B){m.value=a.pageParams.sortOrder==="desc"?a.sortIcon.down:a.sortIcon.up,_.value=B,a.pageParams.sortby=d,a.pageParams.sortOrder=a.pageParams.sortOrder==="desc"?"asc":"desc",e("pagechanged",a.pageParams)}function T(d){e("showTaskRunConfirmModal",d)}function I(d){e("viewAction",d),close()}return{activityLogIconTable:t,addFilters:n,clearFilters:g,data:a,deleteRow:f,emitShowTaskRunConfirmModal:T,isSorted:_,openDrawer:p,pageChanged:r,sortBy:w,sortIcon:m,viewAction:I}}},U={class:"pf-c-drawer__content pf-m-no-background"},W={class:"pf-c-drawer__body pf-m-padding"},X={class:"pf-c-card"},Y={class:"pf-c-table pf-m-compact pf-m-grid-lg",role:"grid",id:"resizeMe"},$={role:"row",id:"headerRow"},ee={key:0},te=["onClick"],ae={class:"pf-c-table__button-content"},oe={class:"pf-c-table__text"},ne={class:"pf-c-table__sort-indicator"},se={key:1,role:"rowgroup"},le=["data-label"],re={key:0},ie={key:1},de={key:0},ce=["onClick"],pe={key:1},fe={key:2,class:"pf-u-danger-color-100",id:"form-help-textinfo-helper","aria-live":"polite"},me={role:"cell","data-label":"Actions",class:"pf-m-fit-content"},_e=["onClick"],ue=["onClick"],be=["onClick"],ge=["onClick"];function we(i,e,a,t,m,_){const u=b("data-table-toolbar"),p=b("data-table-spinner"),f=b("data-table-empty-state"),g=b("data-table-paginate");return s(),l("div",U,[o("div",W,[o("div",X,[C(u,{pagename:a.pagename,onSearchInput:e[0]||(e[0]=n=>t.addFilters(n)),onOpenDrawer:e[1]||(e[1]=n=>t.openDrawer(n)),newBtnEnabled:a.newBtnEnabled,searchInputDisabled:a.searchInputDisabled},{customButtons:q(()=>[K(i.$slots,"customButtons")]),_:3},8,["pagename","newBtnEnabled","searchInputDisabled"]),o("table",Y,[o("thead",null,[o("tr",$,[(s(!0),l(v,null,D(a.tabledata.headers,(n,r)=>(s(),l("th",{key:n.name,class:L(["pf-m-truncate pf-c-table__sort pf-c-table__icon",t.isSorted===r?"pf-m-selected":""])},[n.sortable?c("",!0):(s(),l("span",ee,k(n.label),1)),n.sortable?(s(),l("button",{key:1,class:"pf-c-table__button",onClick:w=>t.sortBy(n.key,r)},[o("div",ae,[o("span",oe,k(n.label),1),o("span",ne,[o("i",{class:L(t.isSorted===r?t.sortIcon:t.data.sortIcon.base)},null,2)])])],8,te)):c("",!0)],2))),128)),e[3]||(e[3]=o("th",{class:"pf-c-table__icon pf-m-fit-content",role:"columnheader",scope:"col"},"Actions",-1))])]),a.tabledata.isLoading?(s(),S(p,{key:0})):c("",!0),a.tabledata.data.total>0||a.tabledata.isLoading?(s(),l("tbody",se,[(s(!0),l(v,null,D(a.tabledata.data.data,n=>(s(),l("tr",{role:"row",key:n.name},[(s(!0),l(v,null,D(a.tabledata.headers,r=>(s(),l("td",{key:r.label,role:"cell","data-label":r.label},[r.isRelationShip===!0?(s(),l("div",re,[(s(!0),l(v,null,D(n[r.key],w=>(s(),l("div",{key:w.id},k(w[r.relationshipKey]),1))),128))])):(s(),l("div",ie,[r.isActionLink?(s(),l("span",de,[o("button",{class:"pf-c-button pf-m-link pf-m-inline",type:"button",onClick:w=>i.$emit("actionLink",n[r.key])},k(n[r.key]),9,ce)])):!r.hasEnabledIcon&&!["report_id"].includes(r.key)?(s(),l("span",pe,k(n[r.key]),1)):c("",!0)])),n.command&&n.command.length<=0&&r.error?(s(),l("p",fe,e[4]||(e[4]=[o("span",{class:"pf-u-danger-color-100"},[o("i",{class:"fas fa-exclamation-circle","aria-hidden":"true"})],-1),y(" This category does not have any commands - "),o("a",{href:"/commands",class:"alink"},"Configure",-1)]))):c("",!0)],8,le))),128)),o("td",me,[o("div",null,[a.taskRunBtnEnabled?(s(),l("button",{key:0,class:"pf-c-button pf-m-link pf-m-small",type:"button",onClick:r=>t.emitShowTaskRunConfirmModal(n.id),alt:"Start this task now!",title:"Start this task now!"},e[5]||(e[5]=[o("span",{class:"pf-c-button__icon pf-m-start"},[o("i",{class:"fa fa-play-circle","aria-hidden":"true"})],-1),y(" Start ")]),8,_e)):c("",!0),a.editBtnEnabled?(s(),l("button",{key:1,class:"pf-c-button pf-m-link pf-m-small",type:"button",onClick:r=>t.openDrawer(n.id),alt:"Edit",title:"Edit"},e[6]||(e[6]=[o("span",{class:"pf-c-button__icon pf-m-start"},[o("i",{class:"fas fa-edit","aria-hidden":"true"})],-1),y(" Edit ")]),8,ue)):c("",!0),a.rowViewBtnEnabled?(s(),l("button",{key:2,class:"pf-c-button pf-m-link pf-m-small",type:"button",onClick:r=>t.viewAction(n.id),alt:"View Details",title:"View Details"},e[7]||(e[7]=[o("span",{class:"pf-c-button__icon pf-m-start"},[o("i",{class:"fas fa-search","aria-hidden":"true"})],-1),y(" View Details ")]),8,be)):c("",!0),o("button",{class:"pf-c-button pf-m-link pf-m-danger pf-m-small",type:"button",onClick:r=>t.deleteRow(n.id),alt:"Delete",title:"Delete"},e[8]||(e[8]=[o("span",{class:"pf-c-button__icon pf-m-start"},[o("i",{class:"fas fa-trash","aria-hidden":"true"})],-1),y(" Delete ")]),8,ge)])])]))),128))])):a.tabledata.isLoading?c("",!0):(s(),S(f,{key:2,onClear:t.clearFilters},null,8,["onClear"]))]),C(g,{from:a.tabledata.data.from,to:a.tabledata.data.to,total:a.tabledata.data.total,current_page:a.tabledata.data.current_page,last_page:a.tabledata.data.last_page,onPagechanged:e[2]||(e[2]=n=>t.pageChanged(n))},null,8,["from","to","total","current_page","last_page"])])])])}const ke=M(Q,[["render",we]]),ye={props:{report_id:{type:String,required:!0}},emits:["closeModal"],components:{LoadingSpinner:G},setup(i,{emit:e}){const a=E("create-notification"),t=h(null),m=h(""),_=h(!1);J(t,f=>p()),P(()=>{u()});function u(){axios.get("/api/reports/"+i.report_id).then(f=>{m.value=f.data,_.value=!1}).catch(f=>{m.value='<h1 class="text-center" style="color: #cc0000;">Error: File not Found!</h1>',_.value=!1,a({type:"danger",title:"Error",message:f.response})})}function p(){e("closeModal")}return{isLoading:_,reportHtml:m,clickOutsidetarget:t,close:p}}},ve={class:"pf-c-backdrop"},he={class:"pf-l-bullseye"},Ce={class:"pf-c-modal-box pf-m-lg","aria-modal":"true",ref:"clickOutsidetarget"},De={key:1,class:"pf-c-modal-box__body"},Re={id:"modal-lg-description"},Se=["innerHTML"],Be={key:2,class:"pf-c-modal-box__footer"};function Le(i,e,a,t,m,_){const u=b("loading-spinner");return s(),l("div",ve,[o("div",he,[o("div",Ce,[C(u,{showSpinner:t.isLoading},null,8,["showSpinner"]),t.isLoading?c("",!0):(s(),l("button",{key:0,class:"pf-c-button pf-m-plain",type:"button","aria-label":"Close dialog",onClick:e[0]||(e[0]=(...p)=>t.close&&t.close(...p))},e[2]||(e[2]=[o("i",{class:"fas fa-times","aria-hidden":"true"},null,-1)]))),t.isLoading?c("",!0):(s(),l("div",De,[o("p",Re,[o("span",{innerHTML:t.reportHtml},null,8,Se)])])),t.isLoading?c("",!0):(s(),l("footer",Be,[o("button",{class:"pf-c-button pf-m-link",type:"button",onClick:e[1]||(e[1]=p=>t.close())},"Close")]))],512)])])}const Me=M(ye,[["render",Le]]),Ee={components:{PageHeader:O,DataTableDownloadReports:ke,SideDrawer:Z,DeleteModal:H,ModalReport:Me},setup(){const i=R({editid:0,pagename:"Download Reports",pagedesc:"rConfig task download reports",pagenamesingle:"Report",modelName:"reports",openDrawerState:!1,showDeleteModal:!1,reportModalState:!1,sideDrawerComponentKey:1,viewReportId:0,pageOptionsState:{page:1,per_page:10,sortby:"created_at",sortOrder:"desc"},modelObject:{report_id:"",task_id:null,task_name:"",task_desc:"",task_type:"",file_name:"",start_time:"",end_time:"",duration:null,created_at:"",updated_at:""}}),{models:e,isLoading:a,dataTablePageChanged:t,deleteRow:m,confirmDelete:_,destroyModel:u}=x(i,i.modelName,i.modelObject);P(()=>{t(i.pageOptionsState)});const p=R({headers:[{key:"report_id",label:"Report",sortable:!0,isActionLink:!0,actionLink:{label:"Download",action:"viewReport"}},{key:"task_id",label:"Task ID",sortable:!0},{key:"task_name",label:"Task Name",sortable:!1},{key:"created_at",label:"Created",sortable:!0}],data:e,isLoading:a});function f(g){i.viewReportId=g,i.reportModalState=!0}return{viewstate:i,dataTablePageChanged:t,deleteRow:m,confirmDelete:_,table:p,destroyModel:u,viewReport:f}}},Pe={class:"pf-c-page__main",tabindex:"-1"},Te={class:"pf-c-page__main-section pf-m-no-padding"},Ie={class:"pf-c-drawer__main"};function xe(i,e,a,t,m,_){const u=b("page-header"),p=b("data-table-download-reports"),f=b("delete-modal"),g=b("modal-report");return s(),l(v,null,[o("main",Pe,[C(u,{pagename:t.viewstate.pagename,desc:t.viewstate.pagedesc},null,8,["pagename","desc"]),e[4]||(e[4]=o("div",{class:"pf-c-divider",role:"separator"},null,-1)),o("section",Te,[o("div",{class:L(["pf-c-drawer",{"pf-m-expanded":t.viewstate.openDrawerState}])},[o("div",Ie,[C(p,{pagename:t.viewstate.pagenamesingle,tabledata:t.table,onPagechanged:t.dataTablePageChanged,onDeleteRow:e[0]||(e[0]=n=>t.deleteRow(n)),onActionLink:e[1]||(e[1]=n=>t.viewReport(n)),newBtnEnabled:!1,editBtnEnabled:!1},null,8,["pagename","tabledata","onPagechanged"])])],2)])]),t.viewstate.showDeleteModal?(s(),S(f,{key:0,editid:t.viewstate.editid,onCloseModal:e[2]||(e[2]=n=>t.viewstate.showDeleteModal=!1),onConfirmDelete:t.confirmDelete},null,8,["editid","onConfirmDelete"])):c("",!0),t.viewstate.reportModalState?(s(),S(g,{key:1,onCloseModal:e[3]||(e[3]=n=>t.viewstate.reportModalState=!1),report_id:t.viewstate.viewReportId},null,8,["report_id"])):c("",!0)],64)}const qe=M(Ee,[["render",xe]]);export{qe as default};
