import{e as Q,b as f,x as X,f as R,y as Y,K as z,g as B,o as c,v as N,w as a,h as s,u as e,z as ee,B as se,C as te,l as o,t as x,E as K,j as d,F,c as E,m as I,G as ae,H as b,A as le,J as oe,L as ne,M as q,N as re,O as ie,P as de}from"./app-CcHmYTTL.js";import{l as ue,m as me,n as ce,o as pe,p as fe,q as G,u as ge,j as ve,_ as _e,a as H,b as T,c as W,d as we,i as ye,e as xe,f as j,g as $e,h as ke}from"./SelectScrollDownButton-29dA9SmK.js";import{u as Z}from"./dialogActions-D8KpvmJH.js";/* empty css               */const be={class:"flex items-center"},Ue={class:"ml-2"},De={class:"grid gap-2 p-4"},Ie={class:"grid items-center grid-cols-4 gap-4"},Ve={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Pe={class:"grid items-center grid-cols-4 gap-4"},Ce={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Ee={class:"grid items-center grid-cols-4 gap-4"},Ne={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Se={class:"grid items-center grid-cols-4 gap-4"},Ae={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},he={class:"grid items-center grid-cols-4 gap-4"},Le={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Me={key:1,class:"col-start-2 -mt-4 text-sm text-green-400"},Ke={class:"grid items-center grid-cols-4 gap-4"},Te={class:"pl-2 ml-auto"},je={class:"bxnAJf2"},Fe={class:"pl-2 ml-auto"},Oe={class:"bxnAJf2"},ze={__name:"UserAddEditDialog",props:{editId:Number},emits:["save"],setup(g,{emit:V}){const{toastSuccess:k,toastError:S,toastInfo:L,toastWarning:A,toastDefault:h}=Q(),P=Z(),{openDialog:O,closeDialog:v,isDialogOpen:M}=P,U=V;f([]);const m=f([]),r=f({name:"",username:"",email:"",password:"",repeat_password:"",role:""}),_=f(""),p=g;function w(y){y.ctrlKey&&y.key==="Enter"&&D()}X(()=>{p.editId>0&&R.get(`/api/users/${p.editId}`).then(y=>{r.value=y.data}),window.addEventListener("keydown",w)}),Y(()=>{window.removeEventListener("keydown",w)}),z(()=>[r.value.password,r.value.repeat_password],()=>{r.value.password!==r.value.repeat_password?(_.value="",m.value.repeat_password=["Passwords do not match"]):(delete m.value.repeat_password,_.value="Passwords match")});function D(){let y=p.editId>0?`/${p.editId}`:"",t=p.editId>0?"patch":"post";R[t]("/api/users"+y,r.value).then($=>{U("save",$.data),k("User created","The tag has been created successfully."),v("DialogNewUser")}).catch($=>{m.value=$.response.data.errors})}return(y,t)=>{const $=B("Icon");return c(),N(e(oe),{open:e(M)("DialogNewUser")},{default:a(()=>[s(e(ee),{"as-child":""}),s(e(le),{class:"p-0 sm:max-w-fit",onEscapeKeyDown:t[9]||(t[9]=u=>e(v)("DialogNewUser")),onPointerDownOutside:t[10]||(t[10]=u=>e(v)("DialogNewUser")),onCloseClicked:t[11]||(t[11]=u=>e(v)("DialogNewUser"))},{default:a(()=>[s(e(se),{class:"rc-dialog-header"},{default:a(()=>[s(e(te),{class:"text-sm text-rcgray-200"},{default:a(()=>[o("div",be,[s($,{icon:"carbon:user-settings"}),o("span",Ue,x(g.editId>0?"Edit":"Add")+" User "+x(g.editId>0?"(ID: "+g.editId+")":""),1)])]),_:1})]),_:1}),o("div",De,[o("div",Ie,[s(e(K),{for:"name",class:"text-right"},{default:a(()=>t[12]||(t[12]=[d(" Name "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(e(F),{modelValue:r.value.name,"onUpdate:modelValue":t[0]||(t[0]=u=>r.value.name=u),id:"name",class:"col-span-3",autocomplete:"off"},null,8,["modelValue"]),m.value.name?(c(),E("span",Ve,x(m.value.name[0]),1)):I("",!0)]),o("div",Pe,[s(e(K),{for:"username",class:"text-right"},{default:a(()=>t[13]||(t[13]=[d(" User Name ")])),_:1}),s(e(F),{modelValue:r.value.username,"onUpdate:modelValue":t[1]||(t[1]=u=>r.value.username=u),id:"username",class:"col-span-3"},null,8,["modelValue"]),m.value.username?(c(),E("span",Ce,x(m.value.username[0]),1)):I("",!0)]),o("div",Ee,[s(e(K),{for:"email",class:"text-right"},{default:a(()=>t[14]||(t[14]=[d(" Email "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(e(F),{modelValue:r.value.email,"onUpdate:modelValue":t[2]||(t[2]=u=>r.value.email=u),id:"email",type:"email",class:"col-span-3"},null,8,["modelValue"]),m.value.email?(c(),E("span",Ne,x(m.value.email[0]),1)):I("",!0)]),o("div",Se,[s(e(K),{for:"password",class:"text-right"},{default:a(()=>t[15]||(t[15]=[d(" Password "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(e(F),{type:"password",modelValue:r.value.password,"onUpdate:modelValue":t[3]||(t[3]=u=>r.value.password=u),id:"password",class:"col-span-3"},null,8,["modelValue"]),m.value.password&&g.editId===0?(c(),E("span",Ae,x(m.value.password[0]),1)):I("",!0)]),o("div",he,[s(e(K),{for:"repeat_password",class:"text-right"},{default:a(()=>t[16]||(t[16]=[d(" Repeat Password "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(e(F),{type:"password",modelValue:r.value.repeat_password,"onUpdate:modelValue":t[4]||(t[4]=u=>r.value.repeat_password=u),id:"repeat_password",class:"col-span-3"},null,8,["modelValue"]),m.value.repeat_password&&g.editId===0?(c(),E("span",Le,x(m.value.repeat_password[0]),1)):I("",!0),_.value&&g.editId===0?(c(),E("span",Me,x(_.value),1)):I("",!0)]),o("div",Ke,[s(e(K),{for:"repeat_password",class:"text-right"},{default:a(()=>t[17]||(t[17]=[d(" Role "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(e(ue),{modelValue:r.value.role,"onUpdate:modelValue":t[5]||(t[5]=u=>r.value.role=u)},{default:a(()=>[s(e(me),{class:"col-span-3"},{default:a(()=>[s(e(ce),{placeholder:"Select a role"})]),_:1}),s(e(pe),null,{default:a(()=>[s(e(fe),null,{default:a(()=>[s(e(G),{value:"admin"},{default:a(()=>t[18]||(t[18]=[d("Admin")])),_:1}),s(e(G),{value:"user"},{default:a(()=>t[19]||(t[19]=[d("User")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),s(e(ae),{class:"rc-dialog-footer bg-rcgray-800"},{default:a(()=>[s(e(b),{type:"close",variant:"outline",class:"px-2 py-1 ml-2 text-sm hover:bg-gray-700 hover:animate-pulse",onClick:t[6]||(t[6]=u=>e(v)("DialogNewUser")),size:"sm"},{default:a(()=>t[20]||(t[20]=[d(" Cancel "),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"bxnAJf"},"ESC")],-1)])),_:1}),p.editId===0?(c(),N(e(b),{key:0,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[7]||(t[7]=u=>D()),variant:"primary"},{default:a(()=>[t[22]||(t[22]=d(" Save ")),o("div",Te,[o("kbd",je,[t[21]||(t[21]=d(" Ctrl  ")),s($,{icon:"uil:enter",class:""})])])]),_:1})):I("",!0),p.editId>0?(c(),N(e(b),{key:1,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[8]||(t[8]=u=>D()),variant:"primary"},{default:a(()=>[t[24]||(t[24]=d(" Update ")),o("div",Fe,[o("kbd",Oe,[t[23]||(t[23]=d(" Ctrl  ")),s($,{icon:"uil:enter",class:""})])])]),_:1})):I("",!0)]),_:1})]),_:1})]),_:1},8,["open"])}}};function Re(){const g=f(1),V=f(parseInt(localStorage.getItem("perPage")||"10")),k=f("-id"),S=f(""),L=f({}),A=Z(),h=f(0),P=f(!1),O=f(1),v=f(1),M=f([]),{openDialog:U}=A,{toastSuccess:m,toastError:r}=Q();async function _(i={}){P.value=!0;try{const C=await R.get("/api/users",{params:{page:g.value,perPage:V.value,sort:k.value,...L.value}});M.value=C.data,O.value=C.data.last_page}catch(C){console.error("Error fetching users:",C),r("Error","Failed to fetch users.")}finally{P.value=!1}}const p=i=>{h.value=0,v.value=Math.random(),U("DialogNewUser")};function w(i){h.value=i,v.value=Math.random(),U("DialogNewUser")}const D=async i=>{try{await R.delete(`/api/users/${i}`),_(),m("User Deleted","The user has been deleted successfully.")}catch(C){console.error("Error deleting user:",C),r("Error","Failed to delete user.")}},y=i=>{h.value=i,v.value=Math.random(),U("DialogNewUser")},t=()=>{_(),v.value=Math.random()};function $(i){i.altKey&&i.key==="n"&&(i.preventDefault(),U("DialogNewUser"))}const u=ne(()=>{L.value["filter[name]"]=S.value,g.value=1,_()},500);z([g,V],()=>{_()}),z(S,()=>{u()}),z(V,i=>{localStorage.setItem("perPage",i.toString())});function l(i){k.value===i?k.value=`-${i}`:k.value=i,_()}return{users:M,isLoading:P,currentPage:g,perPage:V,lastPage:O,editId:h,newUserModalKey:v,searchTerm:S,openDialog:U,fetchUsers:_,createUser:p,updateUser:w,deleteUser:D,handleSave:t,handleKeyDown:$,viewEditDialog:y,toggleSort:l,sortParam:k}}const Be={class:"flex flex-col h-full gap-1 text-center"},Je={class:"flex items-center justify-between p-4"},qe={class:"flex items-center"},Ge={class:"flex"},He={class:"px-6"},Ze={__name:"Main",setup(g){const{editId:V,users:k,currentPage:S,perPage:L,searchTerm:A,lastPage:h,isLoading:P,fetchUsers:O,viewEditDialog:v,createUser:M,deleteUser:U,handleSave:m,handleKeyDown:r,newUserModalKey:_,toggleSort:p,sortParam:w}=Re(),{selectedRows:D,selectAll:y,toggleSelectAll:t,toggleSelectRow:$}=ge(k);return X(()=>{O(),window.addEventListener("keydown",r)}),Y(()=>{window.removeEventListener("keydown",r)}),(u,l)=>{const i=B("Icon"),C=B("Toaster");return c(),E("div",Be,[o("div",Je,[o("div",qe,[s(e(F),{class:"max-w-sm ml-4",autocomplete:"off","data-1p-ignore":"","data-lpignore":"true",placeholder:"Filter users...",modelValue:e(A),"onUpdate:modelValue":l[0]||(l[0]=n=>q(A)?A.value=n:null)},null,8,["modelValue"]),s(e(b),{class:"ml-2 hover:bg-gray-800",variant:"outline",onClick:l[1]||(l[1]=n=>A.value="")},{default:a(()=>l[11]||(l[11]=[d(" Clear Filter ")])),_:1})]),o("div",Ge,[e(D).length?(c(),N(e(b),{key:0,class:"px-2 py-1 bg-red-600 hover:bg-red-700 hover:animate-pulse",size:"md",variant:"primary"},{default:a(()=>[d(" Delete Selected "+x(e(D).length)+" User(s) ",1)]),_:1})):I("",!0),s(e(b),{type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:re(e(M),["prevent"]),variant:"primary"},{default:a(()=>l[12]||(l[12]=[d(" New User "),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"bxnAJf2"},"ALT N")],-1)])),_:1},8,["onClick"])])]),o("div",He,[s(e(ye),null,{default:a(()=>[s(e(_e),null,{default:a(()=>[s(e(H),null,{default:a(()=>[s(e(T),{class:"w-[2%]"},{default:a(()=>[s(e(W),{id:"selectAll",modelValue:e(y),"onUpdate:modelValue":l[2]||(l[2]=n=>q(y)?y.value=n:null),onClick:l[3]||(l[3]=n=>e(t)())},null,8,["modelValue"])]),_:1}),s(e(T),{class:"w-[5%]"},{default:a(()=>[s(e(b),{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:l[4]||(l[4]=n=>e(p)("id"))},{default:a(()=>[s(i,{icon:e(w)==="id"?"lucide:sort-asc":e(w)==="-id"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),l[13]||(l[13]=o("span",{class:"ml-2"},"ID",-1))]),_:1})]),_:1}),s(e(T),{class:"w-[20%]"},{default:a(()=>[s(e(b),{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:l[5]||(l[5]=n=>e(p)("name"))},{default:a(()=>[s(i,{icon:e(w)==="name"?"lucide:sort-asc":e(w)==="-name"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),l[14]||(l[14]=o("span",{class:"ml-2"},"Name",-1))]),_:1})]),_:1}),s(e(T),{class:"w-[20%]"},{default:a(()=>[s(e(b),{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:l[6]||(l[6]=n=>e(p)("email"))},{default:a(()=>[s(i,{icon:e(w)==="email"?"lucide:sort-asc":e(w)==="-email"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),l[15]||(l[15]=o("span",{class:"ml-2"},"Email",-1))]),_:1})]),_:1}),s(e(T),{class:"w-[20%]"},{default:a(()=>[s(e(b),{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:l[7]||(l[7]=n=>e(p)("last_login"))},{default:a(()=>[s(i,{icon:e(w)==="last_login"?"lucide:sort-asc ":e(w)==="-last_login"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),l[16]||(l[16]=o("span",{class:"ml-2"},"Last Login",-1))]),_:1})]),_:1}),s(e(T),{class:"w-[10%]"},{default:a(()=>l[17]||(l[17]=[d("Actions")])),_:1})]),_:1})]),_:1}),s(e(we),null,{default:a(()=>[e(P)?(c(),N(xe,{key:0})):e(P)?(c(),N(ke,{key:2})):(c(!0),E(ie,{key:1},de(e(k).data,n=>(c(),N(e(H),{key:n.id},{default:a(()=>[s(e(j),{class:"text-start"},{default:a(()=>[s(e(W),{class:"cursor-pointer",id:"select-"+n.id,checked:!!e(D).includes(n.id),onClick:J=>e($)(n.id)},null,8,["id","checked","onClick"])]),_:2},1024),s(e(j),{class:"text-start"},{default:a(()=>[d(x(n.id),1)]),_:2},1024),s(e(j),{class:"text-start"},{default:a(()=>[d(x(n.name),1)]),_:2},1024),s(e(j),{class:"text-start"},{default:a(()=>[d(x(n.email),1)]),_:2},1024),s(e(j),{class:"text-start"},{default:a(()=>[d(x(n.last_login),1)]),_:2},1024),s(e(j),{class:"text-start"},{default:a(()=>[s($e,{rowData:n,onOnEdit:J=>e(v)(n.id),onOnDelete:J=>e(U)(n.id)},null,8,["rowData","onOnEdit","onOnDelete"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),s(ve,{currentPage:e(S),lastPage:e(h),perPage:e(L),"onUpdate:currentPage":l[8]||(l[8]=n=>S.value=n),"onUpdate:perPage":l[9]||(l[9]=n=>L.value=n)},null,8,["currentPage","lastPage","perPage"]),(c(),N(ze,{onSave:l[10]||(l[10]=n=>e(m)()),key:e(_),editId:e(V)},null,8,["editId"])),s(C)])])}}};export{Ze as default};
