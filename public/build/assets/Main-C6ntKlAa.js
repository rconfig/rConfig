import{u as X,I as Y,r as f,A as Z,a as z,J as q,T as F,c as U,o as c,z as P,w as l,e as s,f as e,K as ee,M as se,N as te,j as o,t as y,h as i,d as h,k as b,Q as ae,L as le,R as oe,U as ne,V as G,W as re,ah as de,X as J,F as ie,G as ue,Y as ce,Z as K}from"./app-D4qKwC_8.js";import{_ as me}from"./ActionsMenu-BrZ30v9Z.js";import{u as pe,_ as fe,f as ge,a as ve,b as B,c as _e,e as we,d as ye}from"./useRowSelection-NlMFMCDv.js";import{_ as xe,a as ke,b as $e,c as be,d as Ue,e as Q}from"./SelectScrollDownButton-XbsuaHLG.js";/* empty css               */import"./DropdownMenuSeparator.vue_vue_type_script_setup_true_lang-Ci5XrB7N.js";const Ie={class:"flex items-center"},De={class:"ml-2"},Ve={class:"grid gap-2 p-4"},Pe={class:"grid items-center grid-cols-4 gap-2"},Ce={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Ee={class:"grid items-center grid-cols-4 gap-2"},Ne={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Se={class:"grid items-center grid-cols-4 gap-2"},he={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Le={class:"grid items-center grid-cols-4 gap-2"},Me={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Te={class:"grid items-center grid-cols-4 gap-2"},Ae={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Ke={key:1,class:"col-span-3 col-start-2 text-sm text-green-400"},Be={class:"grid items-center grid-cols-4 gap-4"},Re={class:"pl-2 ml-auto"},je={class:"rc-kdb-class2"},Fe={class:"pl-2 ml-auto"},ze={class:"rc-kdb-class2"},Oe={__name:"UserAddEditDialog",props:{editId:Number},emits:["save"],setup(g,{emit:C}){const{toastSuccess:$,toastError:L,toastInfo:T,toastWarning:E,toastDefault:M}=X(),N=Y(),{openDialog:R,closeDialog:m,isDialogOpen:A}=N,I=C;f([]);const u=f([]),r=f({name:"",username:"",email:"",password:"",repeat_password:"",role:""}),v=f(""),p=g;function _(w){w.ctrlKey&&w.key==="Enter"&&D()}Z(()=>{p.editId>0&&z.get(`/api/users/${p.editId}`).then(w=>{r.value=w.data}),window.addEventListener("keydown",_)}),q(()=>{window.removeEventListener("keydown",_)}),F(()=>[r.value.password,r.value.repeat_password],()=>{r.value.password!==r.value.repeat_password?(v.value="",u.value.repeat_password=["Passwords do not match"]):(delete u.value.repeat_password,v.value="Passwords match")});function D(){let w=p.editId>0?`/${p.editId}`:"",t=p.editId>0?"patch":"post";z[t]("/api/users"+w,r.value).then(V=>{I("save",V.data),$("User created","The user has been created successfully."),m("DialogNewUser")}).catch(V=>{u.value=V.response.data.errors})}return(w,t)=>{const V=U("UserIcon"),x=U("Label"),S=U("Input"),a=U("Button"),k=U("Icon");return c(),P(e(oe),{open:e(A)("DialogNewUser")},{default:l(()=>[s(e(ee),{"as-child":""}),s(e(le),{class:"p-0 sm:max-w-fit",onEscapeKeyDown:t[9]||(t[9]=d=>e(m)("DialogNewUser")),onPointerDownOutside:t[10]||(t[10]=d=>e(m)("DialogNewUser")),onCloseClicked:t[11]||(t[11]=d=>e(m)("DialogNewUser"))},{default:l(()=>[s(e(se),{class:"rc-dialog-header"},{default:l(()=>[s(e(te),{class:"text-sm text-rcgray-200"},{default:l(()=>[o("div",Ie,[s(V),o("span",De,y(g.editId>0?"Edit":"Add")+" User "+y(g.editId>0?"(ID: "+g.editId+")":""),1)])]),_:1})]),_:1}),o("div",Ve,[o("div",Pe,[s(x,{for:"name",class:"text-right"},{default:l(()=>t[12]||(t[12]=[i(" Name "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(S,{modelValue:r.value.name,"onUpdate:modelValue":t[0]||(t[0]=d=>r.value.name=d),id:"name",class:"col-span-3",autocomplete:"off"},null,8,["modelValue"]),u.value.name?(c(),h("span",Ce,y(u.value.name[0]),1)):b("",!0)]),o("div",Ee,[s(x,{for:"username",class:"text-right"},{default:l(()=>t[13]||(t[13]=[i(" User Name ")])),_:1}),s(S,{modelValue:r.value.username,"onUpdate:modelValue":t[1]||(t[1]=d=>r.value.username=d),id:"username",class:"col-span-3"},null,8,["modelValue"]),u.value.username?(c(),h("span",Ne,y(u.value.username[0]),1)):b("",!0)]),o("div",Se,[s(x,{for:"email",class:"text-right"},{default:l(()=>t[14]||(t[14]=[i(" Email "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(S,{modelValue:r.value.email,"onUpdate:modelValue":t[2]||(t[2]=d=>r.value.email=d),id:"email",type:"email",class:"col-span-3"},null,8,["modelValue"]),u.value.email?(c(),h("span",he,y(u.value.email[0]),1)):b("",!0)]),o("div",Le,[s(x,{for:"password",class:"text-right"},{default:l(()=>t[15]||(t[15]=[i(" Password "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(S,{type:"password",modelValue:r.value.password,"onUpdate:modelValue":t[3]||(t[3]=d=>r.value.password=d),id:"password",class:"col-span-3"},null,8,["modelValue"]),u.value.password&&g.editId===0?(c(),h("span",Me,y(u.value.password[0]),1)):b("",!0)]),o("div",Te,[s(x,{for:"repeat_password",class:"text-right"},{default:l(()=>t[16]||(t[16]=[i(" Repeat Password "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(S,{type:"password",modelValue:r.value.repeat_password,"onUpdate:modelValue":t[4]||(t[4]=d=>r.value.repeat_password=d),id:"repeat_password",class:"col-span-3"},null,8,["modelValue"]),u.value.repeat_password&&g.editId===0?(c(),h("span",Ae,y(u.value.repeat_password[0]),1)):b("",!0),v.value&&g.editId===0?(c(),h("span",Ke,y(v.value),1)):b("",!0)]),o("div",Be,[s(x,{for:"repeat_password",class:"text-right"},{default:l(()=>t[17]||(t[17]=[i(" Role "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(e(xe),{modelValue:r.value.role,"onUpdate:modelValue":t[5]||(t[5]=d=>r.value.role=d)},{default:l(()=>[s(e(ke),{class:"col-span-3"},{default:l(()=>[s(e($e),{placeholder:"Select a role"})]),_:1}),s(e(be),null,{default:l(()=>[s(e(Ue),null,{default:l(()=>[s(e(Q),{value:"admin"},{default:l(()=>t[18]||(t[18]=[i("Admin")])),_:1}),s(e(Q),{value:"user"},{default:l(()=>t[19]||(t[19]=[i("User")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),s(e(ae),{class:"rc-dialog-footer bg-rcgray-800"},{default:l(()=>[s(a,{type:"close",variant:"outline",class:"px-2 py-1 ml-2 text-sm hover:bg-gray-700 hover:animate-pulse",onClick:t[6]||(t[6]=d=>e(m)("DialogNewUser")),size:"sm"},{default:l(()=>t[20]||(t[20]=[i(" Cancel "),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"rc-kdb-class"},"ESC")],-1)])),_:1}),p.editId===0?(c(),P(a,{key:0,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[7]||(t[7]=d=>D()),variant:"primary"},{default:l(()=>[t[22]||(t[22]=i(" Save ")),o("div",Re,[o("kbd",je,[t[21]||(t[21]=i(" Ctrl  ")),s(k,{icon:"uil:enter",class:""})])])]),_:1})):b("",!0),p.editId>0?(c(),P(a,{key:1,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[8]||(t[8]=d=>D()),variant:"primary"},{default:l(()=>[t[24]||(t[24]=i(" Update ")),o("div",Fe,[o("kbd",ze,[t[23]||(t[23]=i(" Ctrl  ")),s(k,{icon:"uil:enter",class:""})])])]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1},8,["open"])}}};function We(){const g=f(1),C=f(parseInt(localStorage.getItem("perPage")||"10")),$=f("-id"),L=f(""),T=f({}),E=Y(),M=f(0),N=f(!1),R=f(1),m=f(1),A=f([]),{openDialog:I}=E,{toastSuccess:u,toastError:r}=X();async function v(a={}){N.value=!0;try{const k=await z.get("/api/users",{params:{page:g.value,perPage:C.value,sort:$.value,...T.value}});A.value=k.data,R.value=k.data.last_page}catch(k){console.error("Error fetching users:",k),r("Error","Failed to fetch users.")}finally{N.value=!1}}const p=a=>{M.value=0,m.value=Math.random(),I("DialogNewUser")};function _(a){M.value=a,m.value=Math.random(),I("DialogNewUser")}const D=async a=>{try{await z.delete(`/api/users/${a}`),v(),u("User Deleted","The user has been deleted successfully.")}catch(k){console.error("Error deleting user:",k),r("Error","Failed to delete user.")}},w=a=>{M.value=a,m.value=Math.random(),I("DialogNewUser")},t=()=>{v(),m.value=Math.random()};function V(a){a.altKey&&a.key==="n"&&(a.preventDefault(),I("DialogNewUser"))}const x=ne(()=>{T.value["filter[name]"]=L.value,g.value=1,v()},500);F([g,C],()=>{v()}),F(L,()=>{x()}),F(C,a=>{localStorage.setItem("perPage",a.toString())});function S(a){$.value===a?$.value=`-${a}`:$.value=a,v()}return{users:A,isLoading:N,currentPage:g,perPage:C,lastPage:R,editId:M,newUserModalKey:m,searchTerm:L,openDialog:I,fetchUsers:v,createUser:p,updateUser:_,deleteUser:D,handleSave:t,handleKeyDown:V,viewEditDialog:w,toggleSort:S,sortParam:$}}const Ge={class:"flex flex-col h-full gap-1 text-center"},Je={class:"flex items-center justify-between p-4"},Qe={class:"flex items-center"},Xe={class:"flex"},Ye={class:"px-6"},as={__name:"Main",setup(g){const{editId:C,users:$,currentPage:L,perPage:T,searchTerm:E,lastPage:M,isLoading:N,fetchUsers:R,viewEditDialog:m,createUser:A,deleteUser:I,handleSave:u,handleKeyDown:r,newUserModalKey:v,toggleSort:p,sortParam:_}=We(),{selectedRows:D,selectAll:w,toggleSelectAll:t,toggleSelectRow:V}=pe($),x=de();return Z(()=>{R(),window.addEventListener("keydown",r),x.params.userId&&parseInt(x.params.userId,10)>0&&m(x.params.userId)}),q(()=>{window.removeEventListener("keydown",r)}),(S,a)=>{const k=U("Input"),d=U("Button"),O=U("Checkbox"),j=U("Icon"),H=U("Toaster");return c(),h("div",Ge,[o("div",Je,[o("div",Qe,[s(k,{class:"max-w-sm ml-4 mr-2",autocomplete:"off","data-1p-ignore":"","data-lpignore":"true",placeholder:"Filter users...",modelValue:e(E),"onUpdate:modelValue":a[0]||(a[0]=n=>G(E)?E.value=n:null)},null,8,["modelValue"]),e(E)?(c(),P(fe,{key:0,"onUpdate:modelValue":a[1]||(a[1]=n=>E.value="")})):b("",!0)]),o("div",Xe,[e(D).length?(c(),P(d,{key:0,class:"px-2 py-1 bg-red-600 hover:bg-red-700 hover:animate-pulse",size:"md",variant:"primary"},{default:l(()=>[i(" Delete Selected "+y(e(D).length)+" User(s) ",1)]),_:1})):b("",!0),s(d,{type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:re(e(A),["prevent"]),variant:"primary"},{default:l(()=>a[11]||(a[11]=[i(" New User "),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"rc-kdb-class2"},"ALT N")],-1)])),_:1},8,["onClick"])])]),o("div",Ye,[s(e(we),null,{default:l(()=>[s(e(ve),null,{default:l(()=>[s(e(J),null,{default:l(()=>[s(e(B),{class:"w-[2%]"},{default:l(()=>[s(O,{id:"selectAll",modelValue:e(w),"onUpdate:modelValue":a[2]||(a[2]=n=>G(w)?w.value=n:null),onClick:a[3]||(a[3]=n=>e(t)())},null,8,["modelValue"])]),_:1}),s(e(B),{class:"w-[5%]"},{default:l(()=>[s(d,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[4]||(a[4]=n=>e(p)("id"))},{default:l(()=>[s(j,{icon:e(_)==="id"?"lucide:sort-asc":e(_)==="-id"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[12]||(a[12]=o("span",{class:"ml-2"},"ID",-1))]),_:1})]),_:1}),s(e(B),{class:"w-[20%]"},{default:l(()=>[s(d,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[5]||(a[5]=n=>e(p)("name"))},{default:l(()=>[s(j,{icon:e(_)==="name"?"lucide:sort-asc":e(_)==="-name"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[13]||(a[13]=o("span",{class:"ml-2"},"Name",-1))]),_:1})]),_:1}),s(e(B),{class:"w-[20%]"},{default:l(()=>[s(d,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[6]||(a[6]=n=>e(p)("email"))},{default:l(()=>[s(j,{icon:e(_)==="email"?"lucide:sort-asc":e(_)==="-email"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[14]||(a[14]=o("span",{class:"ml-2"},"Email",-1))]),_:1})]),_:1}),s(e(B),{class:"w-[20%]"},{default:l(()=>[s(d,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[7]||(a[7]=n=>e(p)("last_login"))},{default:l(()=>[s(j,{icon:e(_)==="last_login"?"lucide:sort-asc ":e(_)==="-last_login"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[15]||(a[15]=o("span",{class:"ml-2"},"Last Login",-1))]),_:1})]),_:1}),s(e(B),{class:"w-[10%]"},{default:l(()=>a[16]||(a[16]=[i("Actions")])),_:1})]),_:1})]),_:1}),s(e(_e),null,{default:l(()=>[e(N)?(c(),P(ce,{key:0})):e(N)?(c(),P(ye,{key:2})):(c(!0),h(ie,{key:1},ue(e($).data,n=>(c(),P(e(J),{key:n.id},{default:l(()=>[s(e(K),{class:"text-start"},{default:l(()=>[s(O,{class:"cursor-pointer",id:"select-"+n.id,checked:!!e(D).includes(n.id),onClick:W=>e(V)(n.id)},null,8,["id","checked","onClick"])]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[i(y(n.id),1)]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[i(y(n.name),1)]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[i(y(n.email),1)]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[i(y(n.last_login),1)]),_:2},1024),s(e(K),{class:"text-start"},{default:l(()=>[s(me,{rowData:n,onOnEdit:W=>e(m)(n.id),onOnDelete:W=>e(I)(n.id)},null,8,["rowData","onOnEdit","onOnDelete"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),s(ge,{currentPage:e(L),lastPage:e(M),perPage:e(T),"onUpdate:currentPage":a[8]||(a[8]=n=>L.value=n),"onUpdate:perPage":a[9]||(a[9]=n=>T.value=n)},null,8,["currentPage","lastPage","perPage"]),(c(),P(Oe,{onSave:a[10]||(a[10]=n=>e(u)()),key:e(v),editId:e(C)},null,8,["editId"])),s(H)])])}}};export{as as default};
