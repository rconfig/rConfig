import{u as W,r as v,s as G,a as O,y as Q,J as z,b,o as p,q as N,w as l,d as s,e,z as Z,B as ee,C as se,i as o,t as k,g as i,c as S,j as C,H as te,A as ae,I as le,K as oe,L as q,M as ne,F as re,v as de}from"./app-DLQKgLyV.js";import{_ as ie}from"./ActionsMenu-B2wSz_0e.js";import{u as X,a as ue,i as me,_ as ce,b as H,c as K,d as pe,h as ge,e as ve,f as T,g as fe}from"./useRowSelection-5vMTpecC.js";import{_ as _e,a as we,b as ye,c as xe,d as ke,e as J}from"./SelectScrollDownButton-DVOeJHzT.js";/* empty css               */import"./DropdownMenuSeparator.vue_vue_type_script_setup_true_lang-D_5wqxGo.js";const $e={class:"flex items-center"},be={class:"ml-2"},Ue={class:"grid gap-2 p-4"},De={class:"grid items-center grid-cols-4 gap-4"},Ie={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Ve={class:"grid items-center grid-cols-4 gap-4"},Ce={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Pe={class:"grid items-center grid-cols-4 gap-4"},Ee={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Se={class:"grid items-center grid-cols-4 gap-4"},Ne={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},he={class:"grid items-center grid-cols-4 gap-4"},Le={key:0,class:"col-start-2 -mt-4 text-sm text-red-400"},Me={key:1,class:"col-start-2 -mt-4 text-sm text-green-400"},Ae={class:"grid items-center grid-cols-4 gap-4"},Be={class:"pl-2 ml-auto"},Ke={class:"rc-kdb-class2"},Te={class:"pl-2 ml-auto"},Fe={class:"rc-kdb-class2"},je={__name:"UserAddEditDialog",props:{editId:Number},emits:["save"],setup(f,{emit:P}){const{toastSuccess:$,toastError:h,toastInfo:A,toastWarning:L,toastDefault:M}=W(),E=X(),{openDialog:F,closeDialog:_,isDialogOpen:B}=E,U=P;v([]);const m=v([]),r=v({name:"",username:"",email:"",password:"",repeat_password:"",role:""}),w=v(""),g=f;function y(x){x.ctrlKey&&x.key==="Enter"&&D()}G(()=>{g.editId>0&&O.get(`/api/users/${g.editId}`).then(x=>{r.value=x.data}),window.addEventListener("keydown",y)}),Q(()=>{window.removeEventListener("keydown",y)}),z(()=>[r.value.password,r.value.repeat_password],()=>{r.value.password!==r.value.repeat_password?(w.value="",m.value.repeat_password=["Passwords do not match"]):(delete m.value.repeat_password,w.value="Passwords match")});function D(){let x=g.editId>0?`/${g.editId}`:"",t=g.editId>0?"patch":"post";O[t]("/api/users"+x,r.value).then(I=>{U("save",I.data),$("User created","The user has been created successfully."),_("DialogNewUser")}).catch(I=>{m.value=I.response.data.errors})}return(x,t)=>{const I=b("UserIcon"),V=b("Label"),a=b("Input"),d=b("Button"),c=b("Icon");return p(),N(e(le),{open:e(B)("DialogNewUser")},{default:l(()=>[s(e(Z),{"as-child":""}),s(e(ae),{class:"p-0 sm:max-w-fit",onEscapeKeyDown:t[9]||(t[9]=u=>e(_)("DialogNewUser")),onPointerDownOutside:t[10]||(t[10]=u=>e(_)("DialogNewUser")),onCloseClicked:t[11]||(t[11]=u=>e(_)("DialogNewUser"))},{default:l(()=>[s(e(ee),{class:"rc-dialog-header"},{default:l(()=>[s(e(se),{class:"text-sm text-rcgray-200"},{default:l(()=>[o("div",$e,[s(I),o("span",be,k(f.editId>0?"Edit":"Add")+" User "+k(f.editId>0?"(ID: "+f.editId+")":""),1)])]),_:1})]),_:1}),o("div",Ue,[o("div",De,[s(V,{for:"name",class:"text-right"},{default:l(()=>t[12]||(t[12]=[i(" Name "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(a,{modelValue:r.value.name,"onUpdate:modelValue":t[0]||(t[0]=u=>r.value.name=u),id:"name",class:"col-span-3",autocomplete:"off"},null,8,["modelValue"]),m.value.name?(p(),S("span",Ie,k(m.value.name[0]),1)):C("",!0)]),o("div",Ve,[s(V,{for:"username",class:"text-right"},{default:l(()=>t[13]||(t[13]=[i(" User Name ")])),_:1}),s(a,{modelValue:r.value.username,"onUpdate:modelValue":t[1]||(t[1]=u=>r.value.username=u),id:"username",class:"col-span-3"},null,8,["modelValue"]),m.value.username?(p(),S("span",Ce,k(m.value.username[0]),1)):C("",!0)]),o("div",Pe,[s(V,{for:"email",class:"text-right"},{default:l(()=>t[14]||(t[14]=[i(" Email "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(a,{modelValue:r.value.email,"onUpdate:modelValue":t[2]||(t[2]=u=>r.value.email=u),id:"email",type:"email",class:"col-span-3"},null,8,["modelValue"]),m.value.email?(p(),S("span",Ee,k(m.value.email[0]),1)):C("",!0)]),o("div",Se,[s(V,{for:"password",class:"text-right"},{default:l(()=>t[15]||(t[15]=[i(" Password "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(a,{type:"password",modelValue:r.value.password,"onUpdate:modelValue":t[3]||(t[3]=u=>r.value.password=u),id:"password",class:"col-span-3"},null,8,["modelValue"]),m.value.password&&f.editId===0?(p(),S("span",Ne,k(m.value.password[0]),1)):C("",!0)]),o("div",he,[s(V,{for:"repeat_password",class:"text-right"},{default:l(()=>t[16]||(t[16]=[i(" Repeat Password "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(a,{type:"password",modelValue:r.value.repeat_password,"onUpdate:modelValue":t[4]||(t[4]=u=>r.value.repeat_password=u),id:"repeat_password",class:"col-span-3"},null,8,["modelValue"]),m.value.repeat_password&&f.editId===0?(p(),S("span",Le,k(m.value.repeat_password[0]),1)):C("",!0),w.value&&f.editId===0?(p(),S("span",Me,k(w.value),1)):C("",!0)]),o("div",Ae,[s(V,{for:"repeat_password",class:"text-right"},{default:l(()=>t[17]||(t[17]=[i(" Role "),o("span",{class:"text-red-400"},"*",-1)])),_:1}),s(e(_e),{modelValue:r.value.role,"onUpdate:modelValue":t[5]||(t[5]=u=>r.value.role=u)},{default:l(()=>[s(e(we),{class:"col-span-3"},{default:l(()=>[s(e(ye),{placeholder:"Select a role"})]),_:1}),s(e(xe),null,{default:l(()=>[s(e(ke),null,{default:l(()=>[s(e(J),{value:"admin"},{default:l(()=>t[18]||(t[18]=[i("Admin")])),_:1}),s(e(J),{value:"user"},{default:l(()=>t[19]||(t[19]=[i("User")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),s(e(te),{class:"rc-dialog-footer bg-rcgray-800"},{default:l(()=>[s(d,{type:"close",variant:"outline",class:"px-2 py-1 ml-2 text-sm hover:bg-gray-700 hover:animate-pulse",onClick:t[6]||(t[6]=u=>e(_)("DialogNewUser")),size:"sm"},{default:l(()=>t[20]||(t[20]=[i(" Cancel "),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"rc-kdb-class"},"ESC")],-1)])),_:1}),g.editId===0?(p(),N(d,{key:0,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[7]||(t[7]=u=>D()),variant:"primary"},{default:l(()=>[t[22]||(t[22]=i(" Save ")),o("div",Be,[o("kbd",Ke,[t[21]||(t[21]=i(" Ctrl  ")),s(c,{icon:"uil:enter",class:""})])])]),_:1})):C("",!0),g.editId>0?(p(),N(d,{key:1,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:t[8]||(t[8]=u=>D()),variant:"primary"},{default:l(()=>[t[24]||(t[24]=i(" Update ")),o("div",Te,[o("kbd",Fe,[t[23]||(t[23]=i(" Ctrl  ")),s(c,{icon:"uil:enter",class:""})])])]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1},8,["open"])}}};function ze(){const f=v(1),P=v(parseInt(localStorage.getItem("perPage")||"10")),$=v("-id"),h=v(""),A=v({}),L=X(),M=v(0),E=v(!1),F=v(1),_=v(1),B=v([]),{openDialog:U}=L,{toastSuccess:m,toastError:r}=W();async function w(d={}){E.value=!0;try{const c=await O.get("/api/users",{params:{page:f.value,perPage:P.value,sort:$.value,...A.value}});B.value=c.data,F.value=c.data.last_page}catch(c){console.error("Error fetching users:",c),r("Error","Failed to fetch users.")}finally{E.value=!1}}const g=d=>{M.value=0,_.value=Math.random(),U("DialogNewUser")};function y(d){M.value=d,_.value=Math.random(),U("DialogNewUser")}const D=async d=>{try{await O.delete(`/api/users/${d}`),w(),m("User Deleted","The user has been deleted successfully.")}catch(c){console.error("Error deleting user:",c),r("Error","Failed to delete user.")}},x=d=>{M.value=d,_.value=Math.random(),U("DialogNewUser")},t=()=>{w(),_.value=Math.random()};function I(d){d.altKey&&d.key==="n"&&(d.preventDefault(),U("DialogNewUser"))}const V=oe(()=>{A.value["filter[name]"]=h.value,f.value=1,w()},500);z([f,P],()=>{w()}),z(h,()=>{V()}),z(P,d=>{localStorage.setItem("perPage",d.toString())});function a(d){$.value===d?$.value=`-${d}`:$.value=d,w()}return{users:B,isLoading:E,currentPage:f,perPage:P,lastPage:F,editId:M,newUserModalKey:_,searchTerm:h,openDialog:U,fetchUsers:w,createUser:g,updateUser:y,deleteUser:D,handleSave:t,handleKeyDown:I,viewEditDialog:x,toggleSort:a,sortParam:$}}const Oe={class:"flex flex-col h-full gap-1 text-center"},Re={class:"flex items-center justify-between p-4"},qe={class:"flex items-center"},He={class:"flex"},Je={class:"px-6"},es={__name:"Main",setup(f){const{editId:P,users:$,currentPage:h,perPage:A,searchTerm:L,lastPage:M,isLoading:E,fetchUsers:F,viewEditDialog:_,createUser:B,deleteUser:U,handleSave:m,handleKeyDown:r,newUserModalKey:w,toggleSort:g,sortParam:y}=ze(),{selectedRows:D,selectAll:x,toggleSelectAll:t,toggleSelectRow:I}=ue($);return G(()=>{F(),window.addEventListener("keydown",r)}),Q(()=>{window.removeEventListener("keydown",r)}),(V,a)=>{const d=b("Input"),c=b("Button"),u=b("Checkbox"),j=b("Icon"),Y=b("Toaster");return p(),S("div",Oe,[o("div",Re,[o("div",qe,[s(d,{class:"max-w-sm ml-4",autocomplete:"off","data-1p-ignore":"","data-lpignore":"true",placeholder:"Filter users...",modelValue:e(L),"onUpdate:modelValue":a[0]||(a[0]=n=>q(L)?L.value=n:null)},null,8,["modelValue"]),s(c,{class:"ml-2 hover:bg-gray-800",variant:"outline",onClick:a[1]||(a[1]=n=>L.value="")},{default:l(()=>a[11]||(a[11]=[i(" Clear Filter ")])),_:1})]),o("div",He,[e(D).length?(p(),N(c,{key:0,class:"px-2 py-1 bg-red-600 hover:bg-red-700 hover:animate-pulse",size:"md",variant:"primary"},{default:l(()=>[i(" Delete Selected "+k(e(D).length)+" User(s) ",1)]),_:1})):C("",!0),s(c,{type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:ne(e(B),["prevent"]),variant:"primary"},{default:l(()=>a[12]||(a[12]=[i(" New User "),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"rc-kdb-class2"},"ALT N")],-1)])),_:1},8,["onClick"])])]),o("div",Je,[s(e(ge),null,{default:l(()=>[s(e(ce),null,{default:l(()=>[s(e(H),null,{default:l(()=>[s(e(K),{class:"w-[2%]"},{default:l(()=>[s(u,{id:"selectAll",modelValue:e(x),"onUpdate:modelValue":a[2]||(a[2]=n=>q(x)?x.value=n:null),onClick:a[3]||(a[3]=n=>e(t)())},null,8,["modelValue"])]),_:1}),s(e(K),{class:"w-[5%]"},{default:l(()=>[s(c,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[4]||(a[4]=n=>e(g)("id"))},{default:l(()=>[s(j,{icon:e(y)==="id"?"lucide:sort-asc":e(y)==="-id"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[13]||(a[13]=o("span",{class:"ml-2"},"ID",-1))]),_:1})]),_:1}),s(e(K),{class:"w-[20%]"},{default:l(()=>[s(c,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[5]||(a[5]=n=>e(g)("name"))},{default:l(()=>[s(j,{icon:e(y)==="name"?"lucide:sort-asc":e(y)==="-name"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[14]||(a[14]=o("span",{class:"ml-2"},"Name",-1))]),_:1})]),_:1}),s(e(K),{class:"w-[20%]"},{default:l(()=>[s(c,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[6]||(a[6]=n=>e(g)("email"))},{default:l(()=>[s(j,{icon:e(y)==="email"?"lucide:sort-asc":e(y)==="-email"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[15]||(a[15]=o("span",{class:"ml-2"},"Email",-1))]),_:1})]),_:1}),s(e(K),{class:"w-[20%]"},{default:l(()=>[s(c,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[7]||(a[7]=n=>e(g)("last_login"))},{default:l(()=>[s(j,{icon:e(y)==="last_login"?"lucide:sort-asc ":e(y)==="-last_login"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[16]||(a[16]=o("span",{class:"ml-2"},"Last Login",-1))]),_:1})]),_:1}),s(e(K),{class:"w-[10%]"},{default:l(()=>a[17]||(a[17]=[i("Actions")])),_:1})]),_:1})]),_:1}),s(e(pe),null,{default:l(()=>[e(E)?(p(),N(ve,{key:0})):e(E)?(p(),N(fe,{key:2})):(p(!0),S(re,{key:1},de(e($).data,n=>(p(),N(e(H),{key:n.id},{default:l(()=>[s(e(T),{class:"text-start"},{default:l(()=>[s(u,{class:"cursor-pointer",id:"select-"+n.id,checked:!!e(D).includes(n.id),onClick:R=>e(I)(n.id)},null,8,["id","checked","onClick"])]),_:2},1024),s(e(T),{class:"text-start"},{default:l(()=>[i(k(n.id),1)]),_:2},1024),s(e(T),{class:"text-start"},{default:l(()=>[i(k(n.name),1)]),_:2},1024),s(e(T),{class:"text-start"},{default:l(()=>[i(k(n.email),1)]),_:2},1024),s(e(T),{class:"text-start"},{default:l(()=>[i(k(n.last_login),1)]),_:2},1024),s(e(T),{class:"text-start"},{default:l(()=>[s(ie,{rowData:n,onOnEdit:R=>e(_)(n.id),onOnDelete:R=>e(U)(n.id)},null,8,["rowData","onOnEdit","onOnDelete"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),s(me,{currentPage:e(h),lastPage:e(M),perPage:e(A),"onUpdate:currentPage":a[8]||(a[8]=n=>h.value=n),"onUpdate:perPage":a[9]||(a[9]=n=>A.value=n)},null,8,["currentPage","lastPage","perPage"]),(p(),N(je,{onSave:a[10]||(a[10]=n=>e(m)()),key:e(w),editId:e(P)},null,8,["editId"])),s(Y)])])}}};export{es as default};
